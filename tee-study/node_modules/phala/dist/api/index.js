import { createRequire } from 'module';const require = createRequire(import.meta.url);
var li=Object.create;var go=Object.defineProperty;var pi=Object.getOwnPropertyDescriptor;var ui=Object.getOwnPropertyNames;var fi=Object.getPrototypeOf,mi=Object.prototype.hasOwnProperty;var Ce=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var E=(e,t)=>()=>(e&&(t=e(e=0)),t);var X=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var di=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of ui(t))!mi.call(e,n)&&n!==r&&go(e,n,{get:()=>t[n],enumerable:!(o=pi(t,n))||o.enumerable});return e};var xt=(e,t,r)=>(r=e!=null?li(fi(e)):{},di(t||!e||!e.__esModule?go(r,"default",{value:e,enumerable:!0}):r,e));var yo=X((Vu,bo)=>{var Ze=1e3,Ye=Ze*60,Qe=Ye*60,Ne=Qe*24,hi=Ne*7,xi=Ne*365.25;bo.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return gi(e);if(r==="number"&&isFinite(e))return t.long?yi(e):bi(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function gi(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),o=(t[2]||"ms").toLowerCase();switch(o){case"years":case"year":case"yrs":case"yr":case"y":return r*xi;case"weeks":case"week":case"w":return r*hi;case"days":case"day":case"d":return r*Ne;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Qe;case"minutes":case"minute":case"mins":case"min":case"m":return r*Ye;case"seconds":case"second":case"secs":case"sec":case"s":return r*Ze;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function bi(e){var t=Math.abs(e);return t>=Ne?Math.round(e/Ne)+"d":t>=Qe?Math.round(e/Qe)+"h":t>=Ye?Math.round(e/Ye)+"m":t>=Ze?Math.round(e/Ze)+"s":e+"ms"}function yi(e){var t=Math.abs(e);return t>=Ne?zt(e,t,Ne,"day"):t>=Qe?zt(e,t,Qe,"hour"):t>=Ye?zt(e,t,Ye,"minute"):t>=Ze?zt(e,t,Ze,"second"):e+" ms"}function zt(e,t,r,o){var n=t>=r*1.5;return Math.round(e/r)+" "+o+(n?"s":"")}});var _r=X((Ku,vo)=>{function vi(e){r.debug=r,r.default=r,r.coerce=l,r.disable=i,r.enable=n,r.enabled=a,r.humanize=yo(),r.destroy=f,Object.keys(e).forEach(m=>{r[m]=e[m]}),r.names=[],r.skips=[],r.formatters={};function t(m){let p=0;for(let d=0;d<m.length;d++)p=(p<<5)-p+m.charCodeAt(d),p|=0;return r.colors[Math.abs(p)%r.colors.length]}r.selectColor=t;function r(m){let p,d=null,h,I;function T(...P){if(!T.enabled)return;let K=T,W=Number(new Date),O=W-(p||W);K.diff=O,K.prev=p,K.curr=W,p=W,P[0]=r.coerce(P[0]),typeof P[0]!="string"&&P.unshift("%O");let ee=0;P[0]=P[0].replace(/%([a-zA-Z%])/g,(re,Ut)=>{if(re==="%%")return"%";ee++;let xo=r.formatters[Ut];if(typeof xo=="function"){let ci=P[ee];re=xo.call(K,ci),P.splice(ee,1),ee--}return re}),r.formatArgs.call(K,P),(K.log||r.log).apply(K,P)}return T.namespace=m,T.useColors=r.useColors(),T.color=r.selectColor(m),T.extend=o,T.destroy=r.destroy,Object.defineProperty(T,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(h!==r.namespaces&&(h=r.namespaces,I=r.enabled(m)),I),set:P=>{d=P}}),typeof r.init=="function"&&r.init(T),T}function o(m,p){let d=r(this.namespace+(typeof p>"u"?":":p)+m);return d.log=this.log,d}function n(m){r.save(m),r.namespaces=m,r.names=[],r.skips=[];let p=(typeof m=="string"?m:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let d of p)d[0]==="-"?r.skips.push(d.slice(1)):r.names.push(d)}function s(m,p){let d=0,h=0,I=-1,T=0;for(;d<m.length;)if(h<p.length&&(p[h]===m[d]||p[h]==="*"))p[h]==="*"?(I=h,T=d,h++):(d++,h++);else if(I!==-1)h=I+1,T++,d=T;else return!1;for(;h<p.length&&p[h]==="*";)h++;return h===p.length}function i(){let m=[...r.names,...r.skips.map(p=>"-"+p)].join(",");return r.enable(""),m}function a(m){for(let p of r.skips)if(s(m,p))return!1;for(let p of r.names)if(s(m,p))return!0;return!1}function l(m){return m instanceof Error?m.stack||m.message:m}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}vo.exports=vi});var wo=X((J,Ft)=>{J.formatArgs=_i;J.save=Ci;J.load=ki;J.useColors=wi;J.storage=Ti();J.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();J.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function wi(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function _i(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Ft.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(o=r))}),e.splice(o,0,t)}J.log=console.debug||console.log||(()=>{});function Ci(e){try{e?J.storage.setItem("debug",e):J.storage.removeItem("debug")}catch{}}function ki(){let e;try{e=J.storage.getItem("debug")||J.storage.getItem("DEBUG")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function Ti(){try{return localStorage}catch{}}Ft.exports=_r()(J);var{formatters:Ei}=Ft.exports;Ei.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var Co=X((Wu,_o)=>{"use strict";_o.exports=(e,t=process.argv)=>{let r=e.startsWith("-")?"":e.length===1?"-":"--",o=t.indexOf(r+e),n=t.indexOf("--");return o!==-1&&(n===-1||o<n)}});var Eo=X((Xu,To)=>{"use strict";var Si=Ce("os"),ko=Ce("tty"),oe=Co(),{env:z}=process,Ie;oe("no-color")||oe("no-colors")||oe("color=false")||oe("color=never")?Ie=0:(oe("color")||oe("colors")||oe("color=true")||oe("color=always"))&&(Ie=1);"FORCE_COLOR"in z&&(z.FORCE_COLOR==="true"?Ie=1:z.FORCE_COLOR==="false"?Ie=0:Ie=z.FORCE_COLOR.length===0?1:Math.min(parseInt(z.FORCE_COLOR,10),3));function Cr(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function kr(e,t){if(Ie===0)return 0;if(oe("color=16m")||oe("color=full")||oe("color=truecolor"))return 3;if(oe("color=256"))return 2;if(e&&!t&&Ie===void 0)return 0;let r=Ie||0;if(z.TERM==="dumb")return r;if(process.platform==="win32"){let o=Si.release().split(".");return Number(o[0])>=10&&Number(o[2])>=10586?Number(o[2])>=14931?3:2:1}if("CI"in z)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(o=>o in z)||z.CI_NAME==="codeship"?1:r;if("TEAMCITY_VERSION"in z)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(z.TEAMCITY_VERSION)?1:0;if(z.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in z){let o=parseInt((z.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(z.TERM_PROGRAM){case"iTerm.app":return o>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(z.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(z.TERM)||"COLORTERM"in z?1:r}function Ii(e){let t=kr(e,e&&e.isTTY);return Cr(t)}To.exports={supportsColor:Ii,stdout:Cr(kr(!0,ko.isatty(1))),stderr:Cr(kr(!0,ko.isatty(2)))}});var Io=X((F,Ot)=>{var Ai=Ce("tty"),Ht=Ce("util");F.init=zi;F.log=Li;F.formatArgs=Bi;F.save=Ri;F.load=Ui;F.useColors=Pi;F.destroy=Ht.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");F.colors=[6,2,3,4,5,1];try{let e=Eo();e&&(e.stderr||e).level>=2&&(F.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}F.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(n,s)=>s.toUpperCase()),o=process.env[t];return/^(yes|on|true|enabled)$/i.test(o)?o=!0:/^(no|off|false|disabled)$/i.test(o)?o=!1:o==="null"?o=null:o=Number(o),e[r]=o,e},{});function Pi(){return"colors"in F.inspectOpts?!!F.inspectOpts.colors:Ai.isatty(process.stderr.fd)}function Bi(e){let{namespace:t,useColors:r}=this;if(r){let o=this.color,n="\x1B[3"+(o<8?o:"8;5;"+o),s=`  ${n};1m${t} \x1B[0m`;e[0]=s+e[0].split(`
`).join(`
`+s),e.push(n+"m+"+Ot.exports.humanize(this.diff)+"\x1B[0m")}else e[0]=$i()+t+" "+e[0]}function $i(){return F.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Li(...e){return process.stderr.write(Ht.formatWithOptions(F.inspectOpts,...e)+`
`)}function Ri(e){e?process.env.DEBUG=e:delete process.env.DEBUG}function Ui(){return process.env.DEBUG}function zi(e){e.inspectOpts={};let t=Object.keys(F.inspectOpts);for(let r=0;r<t.length;r++)e.inspectOpts[t[r]]=F.inspectOpts[t[r]]}Ot.exports=_r()(F);var{formatters:So}=Ot.exports;So.o=function(e){return this.inspectOpts.colors=this.useColors,Ht.inspect(e,this.inspectOpts).split(`
`).map(t=>t.trim()).join(" ")};So.O=function(e){return this.inspectOpts.colors=this.useColors,Ht.inspect(e,this.inspectOpts)}});var Ao=X((Ju,Tr)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Tr.exports=wo():Tr.exports=Io()});var Er,Bo=E(()=>{Er="2.38.6"});function $o(e,t){return t?.(e)?e:e&&typeof e=="object"&&"cause"in e&&e.cause!==void 0?$o(e.cause,t):t?null:e}var Sr,b,ne=E(()=>{Bo();Sr={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:r})=>t?`${e??"https://viem.sh"}${t}${r?`#${r}`:""}`:void 0,version:`viem@${Er}`},b=class e extends Error{constructor(t,r={}){let o=r.cause instanceof e?r.cause.details:r.cause?.message?r.cause.message:r.details,n=r.cause instanceof e&&r.cause.docsPath||r.docsPath,s=Sr.getDocsUrl?.({...r,docsPath:n}),i=[t||"An error occurred.","",...r.metaMessages?[...r.metaMessages,""]:[],...s?[`Docs: ${s}`]:[],...o?[`Details: ${o}`]:[],...Sr.version?[`Version: ${Sr.version}`]:[]].join(`
`);super(i,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=o,this.docsPath=n,this.metaMessages=r.metaMessages,this.name=r.name??this.name,this.shortMessage=t,this.version=Er}walk(t){return $o(this,t)}}});var jt,Nt,Ir=E(()=>{ne();jt=class extends b{constructor({max:t,min:r,signed:o,size:n,value:s}){super(`Number "${s}" is not in safe ${n?`${n*8}-bit ${o?"signed":"unsigned"} `:""}integer range ${t?`(${r} to ${t})`:`(above ${r})`}`,{name:"IntegerOutOfRangeError"})}},Nt=class extends b{constructor({givenSize:t,maxSize:r}){super(`Size cannot exceed ${r} bytes. Given size: ${t} bytes.`,{name:"SizeOverflowError"})}}});function he(e,{strict:t=!0}={}){return!e||typeof e!="string"?!1:t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")}var et=E(()=>{});function se(e){return he(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}var gt=E(()=>{et()});function bt(e,{dir:t="left"}={}){let r=typeof e=="string"?e.replace("0x",""):e,o=0;for(let n=0;n<r.length-1&&r[t==="left"?n:r.length-n-1].toString()==="0";n++)o++;return r=t==="left"?r.slice(o):r.slice(0,r.length-o),typeof e=="string"?(r.length===1&&t==="right"&&(r=`${r}0`),`0x${r.length%2===1?`0${r}`:r}`):r}var Lo=E(()=>{});var yt,vt,Ar=E(()=>{ne();yt=class extends b{constructor({offset:t,position:r,size:o}){super(`Slice ${r==="start"?"starting":"ending"} at offset "${t}" is out-of-bounds (size: ${o}).`,{name:"SliceOffsetOutOfBoundsError"})}},vt=class extends b{constructor({size:t,targetSize:r,type:o}){super(`${o.charAt(0).toUpperCase()}${o.slice(1).toLowerCase()} size (${t}) exceeds padding size (${r}).`,{name:"SizeExceedsPaddingSizeError"})}}});function Ae(e,{dir:t,size:r=32}={}){return typeof e=="string"?Fi(e,{dir:t,size:r}):Hi(e,{dir:t,size:r})}function Fi(e,{dir:t,size:r=32}={}){if(r===null)return e;let o=e.replace("0x","");if(o.length>r*2)throw new vt({size:Math.ceil(o.length/2),targetSize:r,type:"hex"});return`0x${o[t==="right"?"padEnd":"padStart"](r*2,"0")}`}function Hi(e,{dir:t,size:r=32}={}){if(r===null)return e;if(e.length>r)throw new vt({size:e.length,targetSize:r,type:"bytes"});let o=new Uint8Array(r);for(let n=0;n<r;n++){let s=t==="right";o[s?n:r-n-1]=e[s?n:e.length-n-1]}return o}var Pr=E(()=>{Ar()});function pe(e,t={}){return typeof e=="number"||typeof e=="bigint"?_(e,t):typeof e=="string"?qi(e,t):typeof e=="boolean"?ji(e,t):Z(e,t)}function ji(e,t={}){let r=`0x${Number(e)}`;return typeof t.size=="number"?(Pe(r,{size:t.size}),Ae(r,{size:t.size})):r}function Z(e,t={}){let r="";for(let n=0;n<e.length;n++)r+=Oi[e[n]];let o=`0x${r}`;return typeof t.size=="number"?(Pe(o,{size:t.size}),Ae(o,{dir:"right",size:t.size})):o}function _(e,t={}){let{signed:r,size:o}=t,n=BigInt(e),s;o?r?s=(1n<<BigInt(o)*8n-1n)-1n:s=2n**(BigInt(o)*8n)-1n:typeof e=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));let i=typeof s=="bigint"&&r?-s-1n:0;if(s&&n>s||n<i){let l=typeof e=="bigint"?"n":"";throw new jt({max:s?`${s}${l}`:void 0,min:`${i}${l}`,signed:r,size:o,value:`${e}${l}`})}let a=`0x${(r&&n<0?(1n<<BigInt(o*8))+BigInt(n):n).toString(16)}`;return o?Ae(a,{size:o}):a}function qi(e,t={}){let r=Ni.encode(e);return Z(r,t)}var Oi,Ni,ie=E(()=>{Ir();Pr();Me();Oi=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));Ni=new TextEncoder});function qt(e,t={}){return typeof e=="number"||typeof e=="bigint"?Di(e,t):typeof e=="boolean"?Gi(e,t):he(e)?ue(e,t):Br(e,t)}function Gi(e,t={}){let r=new Uint8Array(1);return r[0]=Number(e),typeof t.size=="number"?(Pe(r,{size:t.size}),Ae(r,{size:t.size})):r}function Ro(e){if(e>=ke.zero&&e<=ke.nine)return e-ke.zero;if(e>=ke.A&&e<=ke.F)return e-(ke.A-10);if(e>=ke.a&&e<=ke.f)return e-(ke.a-10)}function ue(e,t={}){let r=e;t.size&&(Pe(r,{size:t.size}),r=Ae(r,{dir:"right",size:t.size}));let o=r.slice(2);o.length%2&&(o=`0${o}`);let n=o.length/2,s=new Uint8Array(n);for(let i=0,a=0;i<n;i++){let l=Ro(o.charCodeAt(a++)),f=Ro(o.charCodeAt(a++));if(l===void 0||f===void 0)throw new b(`Invalid byte sequence ("${o[a-2]}${o[a-1]}" in "${o}").`);s[i]=l*16+f}return s}function Di(e,t){let r=_(e,t);return ue(r)}function Br(e,t={}){let r=Mi.encode(e);return typeof t.size=="number"?(Pe(r,{size:t.size}),Ae(r,{dir:"right",size:t.size})):r}var Mi,ke,Be=E(()=>{ne();et();Pr();Me();ie();Mi=new TextEncoder;ke={zero:48,nine:57,A:65,F:70,a:97,f:102}});function Pe(e,{size:t}){if(se(e)>t)throw new Nt({givenSize:se(e),maxSize:t})}function Ge(e,t={}){let{signed:r}=t;t.size&&Pe(e,{size:t.size});let o=BigInt(e);if(!r)return o;let n=(e.length-2)/2,s=(1n<<BigInt(n)*8n-1n)-1n;return o<=s?o:o-BigInt(`0x${"f".padStart(n*2,"f")}`)-1n}function De(e,t={}){return Number(Ge(e,t))}var Me=E(()=>{Ir();gt()});function tt(e,t){return({exclude:r,format:o})=>({exclude:r,format:(n,s)=>{let i=t(n,s);if(r)for(let a of r)delete i[a];return{...i,...o(n,s)}},type:e})}var Mt=E(()=>{});var jf,Nf,qf,Mf,Gf,Df,Vf,Kf,Wf,Xf,Jf,Zf,Yf,Qf,em,tm,rm,om,nm,sm,im,am,cm,lm,pm,um,fm,mm,dm,hm,xm,gm,bm,ym,vm,wm,_m,Cm,km,Tm,Em,Sm,Im,Am,Pm,Bm,$m,Lm,Rm,Um,zm,Fm,Hm,Om,jm,Nm,qm,Mm,Gm,Dm,Vm,Km,Wm,Xm,Jm,Zm,Ym,Qm,ed,td,rd,od,nd,sd,id,ad,cd,ld,pd,ud,fd,md,dd,hd,xd,gd,bd,yd,vd,wd,_d,Cd,kd,Td,Ed,Gt,Oo=E(()=>{jf=2n**(8n-1n)-1n,Nf=2n**(16n-1n)-1n,qf=2n**(24n-1n)-1n,Mf=2n**(32n-1n)-1n,Gf=2n**(40n-1n)-1n,Df=2n**(48n-1n)-1n,Vf=2n**(56n-1n)-1n,Kf=2n**(64n-1n)-1n,Wf=2n**(72n-1n)-1n,Xf=2n**(80n-1n)-1n,Jf=2n**(88n-1n)-1n,Zf=2n**(96n-1n)-1n,Yf=2n**(104n-1n)-1n,Qf=2n**(112n-1n)-1n,em=2n**(120n-1n)-1n,tm=2n**(128n-1n)-1n,rm=2n**(136n-1n)-1n,om=2n**(144n-1n)-1n,nm=2n**(152n-1n)-1n,sm=2n**(160n-1n)-1n,im=2n**(168n-1n)-1n,am=2n**(176n-1n)-1n,cm=2n**(184n-1n)-1n,lm=2n**(192n-1n)-1n,pm=2n**(200n-1n)-1n,um=2n**(208n-1n)-1n,fm=2n**(216n-1n)-1n,mm=2n**(224n-1n)-1n,dm=2n**(232n-1n)-1n,hm=2n**(240n-1n)-1n,xm=2n**(248n-1n)-1n,gm=2n**(256n-1n)-1n,bm=-(2n**(8n-1n)),ym=-(2n**(16n-1n)),vm=-(2n**(24n-1n)),wm=-(2n**(32n-1n)),_m=-(2n**(40n-1n)),Cm=-(2n**(48n-1n)),km=-(2n**(56n-1n)),Tm=-(2n**(64n-1n)),Em=-(2n**(72n-1n)),Sm=-(2n**(80n-1n)),Im=-(2n**(88n-1n)),Am=-(2n**(96n-1n)),Pm=-(2n**(104n-1n)),Bm=-(2n**(112n-1n)),$m=-(2n**(120n-1n)),Lm=-(2n**(128n-1n)),Rm=-(2n**(136n-1n)),Um=-(2n**(144n-1n)),zm=-(2n**(152n-1n)),Fm=-(2n**(160n-1n)),Hm=-(2n**(168n-1n)),Om=-(2n**(176n-1n)),jm=-(2n**(184n-1n)),Nm=-(2n**(192n-1n)),qm=-(2n**(200n-1n)),Mm=-(2n**(208n-1n)),Gm=-(2n**(216n-1n)),Dm=-(2n**(224n-1n)),Vm=-(2n**(232n-1n)),Km=-(2n**(240n-1n)),Wm=-(2n**(248n-1n)),Xm=-(2n**(256n-1n)),Jm=2n**8n-1n,Zm=2n**16n-1n,Ym=2n**24n-1n,Qm=2n**32n-1n,ed=2n**40n-1n,td=2n**48n-1n,rd=2n**56n-1n,od=2n**64n-1n,nd=2n**72n-1n,sd=2n**80n-1n,id=2n**88n-1n,ad=2n**96n-1n,cd=2n**104n-1n,ld=2n**112n-1n,pd=2n**120n-1n,ud=2n**128n-1n,fd=2n**136n-1n,md=2n**144n-1n,dd=2n**152n-1n,hd=2n**160n-1n,xd=2n**168n-1n,gd=2n**176n-1n,bd=2n**184n-1n,yd=2n**192n-1n,vd=2n**200n-1n,wd=2n**208n-1n,_d=2n**216n-1n,Cd=2n**224n-1n,kd=2n**232n-1n,Td=2n**240n-1n,Ed=2n**248n-1n,Gt=2n**256n-1n});function Ve(e){return`0x${e.reduce((t,r)=>t+r.replace("0x",""),"")}`}var Lr=E(()=>{});var _t,Dt,Vt,jo=E(()=>{ne();_t=class extends b{constructor({offset:t}){super(`Offset \`${t}\` cannot be negative.`,{name:"NegativeOffsetError"})}},Dt=class extends b{constructor({length:t,position:r}){super(`Position \`${r}\` is out of bounds (\`0 < position < ${t}\`).`,{name:"PositionOutOfBoundsError"})}},Vt=class extends b{constructor({count:t,limit:r}){super(`Recursive read limit of \`${r}\` exceeded (recursive read count: \`${t}\`).`,{name:"RecursiveReadLimitExceededError"})}}});function Kt(e,{recursiveReadLimit:t=8192}={}){let r=Object.create(Ji);return r.bytes=e,r.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength),r.positionReadCount=new Map,r.recursiveReadLimit=t,r}var Ji,Rr=E(()=>{jo();Ji={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new Vt({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(e){if(e<0||e>this.bytes.length-1)throw new Dt({length:this.bytes.length,position:e})},decrementPosition(e){if(e<0)throw new _t({offset:e});let t=this.position-e;this.assertPosition(t),this.position=t},getReadCount(e){return this.positionReadCount.get(e||this.position)||0},incrementPosition(e){if(e<0)throw new _t({offset:e});let t=this.position+e;this.assertPosition(t),this.position=t},inspectByte(e){let t=e??this.position;return this.assertPosition(t),this.bytes[t]},inspectBytes(e,t){let r=t??this.position;return this.assertPosition(r+e-1),this.bytes.subarray(r,r+e)},inspectUint8(e){let t=e??this.position;return this.assertPosition(t),this.bytes[t]},inspectUint16(e){let t=e??this.position;return this.assertPosition(t+1),this.dataView.getUint16(t)},inspectUint24(e){let t=e??this.position;return this.assertPosition(t+2),(this.dataView.getUint16(t)<<8)+this.dataView.getUint8(t+2)},inspectUint32(e){let t=e??this.position;return this.assertPosition(t+3),this.dataView.getUint32(t)},pushByte(e){this.assertPosition(this.position),this.bytes[this.position]=e,this.position++},pushBytes(e){this.assertPosition(this.position+e.length-1),this.bytes.set(e,this.position),this.position+=e.length},pushUint8(e){this.assertPosition(this.position),this.bytes[this.position]=e,this.position++},pushUint16(e){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,e),this.position+=2},pushUint24(e){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,e>>8),this.dataView.setUint8(this.position+2,e&255),this.position+=3},pushUint32(e){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,e),this.position+=4},readByte(){this.assertReadLimit(),this._touch();let e=this.inspectByte();return this.position++,e},readBytes(e,t){this.assertReadLimit(),this._touch();let r=this.inspectBytes(e);return this.position+=t??e,r},readUint8(){this.assertReadLimit(),this._touch();let e=this.inspectUint8();return this.position+=1,e},readUint16(){this.assertReadLimit(),this._touch();let e=this.inspectUint16();return this.position+=2,e},readUint24(){this.assertReadLimit(),this._touch();let e=this.inspectUint24();return this.position+=3,e},readUint32(){this.assertReadLimit(),this._touch();let e=this.inspectUint32();return this.position+=4,e},get remaining(){return this.bytes.length-this.position},setPosition(e){let t=this.position;return this.assertPosition(e),this.position=e,()=>this.position=t},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;let e=this.getReadCount();this.positionReadCount.set(this.position,e+1),e>0&&this.recursiveReadCount++}}});var Mo,Go=E(()=>{Mo={ether:-9,wei:9}});function Do(e,t){let r=e.toString(),o=r.startsWith("-");o&&(r=r.slice(1)),r=r.padStart(t,"0");let[n,s]=[r.slice(0,r.length-t),r.slice(r.length-t)];return s=s.replace(/(0+)$/,""),`${o?"-":""}${n||"0"}${s?`.${s}`:""}`}var Vo=E(()=>{});function Ct(e,t="wei"){return Do(e,Mo[t])}var Ko=E(()=>{Go();Vo()});function Qi(e){let t=Object.entries(e).map(([o,n])=>n===void 0||n===!1?null:[o,n]).filter(Boolean),r=t.reduce((o,[n])=>Math.max(o,n.length),0);return t.map(([o,n])=>`  ${`${o}:`.padEnd(r+1)}  ${n}`).join(`
`)}var Wt,Xt,Jt,Zt=E(()=>{ne();Wt=class extends b{constructor({v:t}){super(`Invalid \`v\` value "${t}". Expected 27 or 28.`,{name:"InvalidLegacyVError"})}},Xt=class extends b{constructor({transaction:t}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",Qi(t),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}},Jt=class extends b{constructor({storageKey:t}){super(`Size for storage key "${t}" is invalid. Expected 32 bytes. Got ${Math.floor((t.length-2)/2)} bytes.`,{name:"InvalidStorageKeySizeError"})}}});function ea(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ur(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Ke(e,...t){if(!ea(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function nt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function er(e,t){Ke(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Xo(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function $e(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function tr(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function fe(e,t){return e<<32-t|e>>>t}function ra(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function oa(e){for(let t=0;t<e.length;t++)e[t]=ra(e[t]);return e}function na(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function kt(e){return typeof e=="string"&&(e=na(e)),Ke(e),e}function rr(e){let t=o=>e().update(kt(o)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}var ta,zr,ot,or=E(()=>{ta=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;zr=ta?e=>e:oa;ot=class{}});function ia(e,t=!1){return t?{h:Number(e&sr),l:Number(e>>Yo&sr)}:{h:Number(e>>Yo&sr)|0,l:Number(e&sr)|0}}function Qo(e,t=!1){let r=e.length,o=new Uint32Array(r),n=new Uint32Array(r);for(let s=0;s<r;s++){let{h:i,l:a}=ia(e[s],t);[o[s],n[s]]=[i,a]}return[o,n]}var sr,Yo,en,tn,rn,on,nn=E(()=>{sr=BigInt(4294967295),Yo=BigInt(32);en=(e,t,r)=>e<<r|t>>>32-r,tn=(e,t,r)=>t<<r|e>>>32-r,rn=(e,t,r)=>t<<r-32|e>>>64-r,on=(e,t,r)=>e<<r-32|t>>>64-r});var ae,pr=E(()=>{ne();ae=class extends b{constructor({address:t}){super(`Address "${t}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}});var We,mn=E(()=>{ne();We=class extends b{constructor({chainId:t}){super(typeof t=="number"?`Chain ID "${t}" is invalid.`:"Chain ID is invalid.",{name:"InvalidChainIdError"})}}});var ur,Xe,Fr,Hr,Or,jr,Nr,qr,Mr,Gr,Tt,dn=E(()=>{Ko();ne();ur=class extends b{constructor({cause:t,message:r}={}){let o=r?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${o?`with reason: ${o}`:"for an unknown reason"}.`,{cause:t,name:"ExecutionRevertedError"})}};Object.defineProperty(ur,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(ur,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});Xe=class extends b{constructor({cause:t,maxFeePerGas:r}={}){super(`The fee cap (\`maxFeePerGas\`${r?` = ${Ct(r)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:t,name:"FeeCapTooHighError"})}};Object.defineProperty(Xe,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});Fr=class extends b{constructor({cause:t,maxFeePerGas:r}={}){super(`The fee cap (\`maxFeePerGas\`${r?` = ${Ct(r)}`:""} gwei) cannot be lower than the block base fee.`,{cause:t,name:"FeeCapTooLowError"})}};Object.defineProperty(Fr,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});Hr=class extends b{constructor({cause:t,nonce:r}={}){super(`Nonce provided for the transaction ${r?`(${r}) `:""}is higher than the next one expected.`,{cause:t,name:"NonceTooHighError"})}};Object.defineProperty(Hr,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});Or=class extends b{constructor({cause:t,nonce:r}={}){super([`Nonce provided for the transaction ${r?`(${r}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:t,name:"NonceTooLowError"})}};Object.defineProperty(Or,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});jr=class extends b{constructor({cause:t,nonce:r}={}){super(`Nonce provided for the transaction ${r?`(${r}) `:""}exceeds the maximum allowed nonce.`,{cause:t,name:"NonceMaxValueError"})}};Object.defineProperty(jr,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});Nr=class extends b{constructor({cause:t}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:t,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}};Object.defineProperty(Nr,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});qr=class extends b{constructor({cause:t,gas:r}={}){super(`The amount of gas ${r?`(${r}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:t,name:"IntrinsicGasTooHighError"})}};Object.defineProperty(qr,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});Mr=class extends b{constructor({cause:t,gas:r}={}){super(`The amount of gas ${r?`(${r}) `:""}provided for the transaction is too low.`,{cause:t,name:"IntrinsicGasTooLowError"})}};Object.defineProperty(Mr,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});Gr=class extends b{constructor({cause:t}){super("The transaction type is not supported for this chain.",{cause:t,name:"TransactionTypeNotSupportedError"})}};Object.defineProperty(Gr,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});Tt=class extends b{constructor({cause:t,maxPriorityFeePerGas:r,maxFeePerGas:o}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${r?` = ${Ct(r)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${o?` = ${Ct(o)} gwei`:""}).`].join(`
`),{cause:t,name:"TipAboveFeeCapError"})}};Object.defineProperty(Tt,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/})});var it,Dr=E(()=>{it=class extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){let r=super.get(t);return super.has(t)&&r!==void 0&&(this.delete(t),super.set(t,r)),r}set(t,r){if(super.set(t,r),this.maxSize&&this.size>this.maxSize){let o=this.keys().next().value;o&&this.delete(o)}return this}}});function ga(e,t=24){let r=new Uint32Array(10);for(let o=24-t;o<24;o++){for(let i=0;i<10;i++)r[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){let a=(i+8)%10,l=(i+2)%10,f=r[l],m=r[l+1],p=hn(f,m,1)^r[a],d=xn(f,m,1)^r[a+1];for(let h=0;h<50;h+=10)e[i+h]^=p,e[i+h+1]^=d}let n=e[2],s=e[3];for(let i=0;i<24;i++){let a=bn[i],l=hn(n,s,a),f=xn(n,s,a),m=gn[i];n=e[m],s=e[m+1],e[m]=l,e[m+1]=f}for(let i=0;i<50;i+=10){for(let a=0;a<10;a++)r[a]=e[i+a];for(let a=0;a<10;a++)e[i+a]^=~r[(a+2)%10]&r[(a+4)%10]}e[0]^=ha[o],e[1]^=xa[o]}$e(r)}var pa,Et,ua,fa,ma,da,gn,bn,yn,vn,ha,xa,hn,xn,Vr,ba,wn,_n=E(()=>{nn();or();pa=BigInt(0),Et=BigInt(1),ua=BigInt(2),fa=BigInt(7),ma=BigInt(256),da=BigInt(113),gn=[],bn=[],yn=[];for(let e=0,t=Et,r=1,o=0;e<24;e++){[r,o]=[o,(2*r+3*o)%5],gn.push(2*(5*o+r)),bn.push((e+1)*(e+2)/2%64);let n=pa;for(let s=0;s<7;s++)t=(t<<Et^(t>>fa)*da)%ma,t&ua&&(n^=Et<<(Et<<BigInt(s))-Et);yn.push(n)}vn=Qo(yn,!0),ha=vn[0],xa=vn[1],hn=(e,t,r)=>r>32?rn(e,t,r):en(e,t,r),xn=(e,t,r)=>r>32?on(e,t,r):tn(e,t,r);Vr=class e extends ot{constructor(t,r,o,n=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=r,this.outputLen=o,this.enableXOF=n,this.rounds=s,Ur(o),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Xo(this.state)}clone(){return this._cloneInto()}keccak(){zr(this.state32),ga(this.state32,this.rounds),zr(this.state32),this.posOut=0,this.pos=0}update(t){nt(this),t=kt(t),Ke(t);let{blockLen:r,state:o}=this,n=t.length;for(let s=0;s<n;){let i=Math.min(r-this.pos,n-s);for(let a=0;a<i;a++)o[this.pos++]^=t[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:o,blockLen:n}=this;t[o]^=r,(r&128)!==0&&o===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){nt(this,!1),Ke(t),this.finish();let r=this.state,{blockLen:o}=this;for(let n=0,s=t.length;n<s;){this.posOut>=o&&this.keccak();let i=Math.min(o-this.posOut,s-n);t.set(r.subarray(this.posOut,this.posOut+i),n),this.posOut+=i,n+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Ur(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(er(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,$e(this.state)}_cloneInto(t){let{blockLen:r,suffix:o,outputLen:n,rounds:s,enableXOF:i}=this;return t||(t=new e(r,o,n,i,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=o,t.outputLen=n,t.enableXOF=i,t.destroyed=this.destroyed,t}},ba=(e,t,r)=>rr(()=>new Vr(t,e,r)),wn=ba(1,136,256/8)});function Cn(e,t){let r=t||"hex",o=wn(he(e,{strict:!1})?qt(e):e);return r==="bytes"?o:pe(o)}var kn=E(()=>{_n();et();Be();ie()});function Tn(e,t){if(Kr.has(`${e}.${t}`))return Kr.get(`${e}.${t}`);let r=t?`${t}${e.toLowerCase()}`:e.substring(2).toLowerCase(),o=Cn(Br(r),"bytes"),n=(t?r.substring(`${t}0x`.length):r).split("");for(let i=0;i<40;i+=2)o[i>>1]>>4>=8&&n[i]&&(n[i]=n[i].toUpperCase()),(o[i>>1]&15)>=8&&n[i+1]&&(n[i+1]=n[i+1].toUpperCase());let s=`0x${n.join("")}`;return Kr.set(`${e}.${t}`,s),s}var Kr,En=E(()=>{Be();kn();Dr();Kr=new it(8192)});function xe(e,t){let{strict:r=!0}=t??{},o=`${e}.${r}`;if(Wr.has(o))return Wr.get(o);let n=ya.test(e)?e.toLowerCase()===e?!0:r?Tn(e)===e:!0:!1;return Wr.set(o,n),n}var ya,Wr,fr=E(()=>{Dr();En();ya=/^0x[a-fA-F0-9]{40}$/,Wr=new it(8192)});function Sn(e,t,r,{strict:o}={}){return he(e,{strict:!1})?wa(e,t,r,{strict:o}):va(e,t,r,{strict:o})}function In(e,t){if(typeof t=="number"&&t>0&&t>se(e)-1)throw new yt({offset:t,position:"start",size:se(e)})}function An(e,t,r){if(typeof t=="number"&&typeof r=="number"&&se(e)!==r-t)throw new yt({offset:r,position:"end",size:se(e)})}function va(e,t,r,{strict:o}={}){In(e,t);let n=e.slice(t,r);return o&&An(n,t,r),n}function wa(e,t,r,{strict:o}={}){In(e,t);let n=`0x${e.replace("0x","").slice((t??0)*2,(r??e.length)*2)}`;return o&&An(n,t,r),n}var Pn=E(()=>{Ar();et();gt()});var Yr=X(Pt=>{"use strict";var $a=Pt&&Pt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.encryptEnvVars=Ua;var Jr=Ce("@noble/curves/ed25519"),Zr=$a(Ce("crypto"));function La(e){var t,r;return e=e.startsWith("0x")?e.slice(2):e,new Uint8Array((r=(t=e.match(/.{1,2}/g))===null||t===void 0?void 0:t.map(o=>parseInt(o,16)))!==null&&r!==void 0?r:[])}function Ra(e){return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}async function Ua(e,t){let r=JSON.stringify({env:e}),o=Jr.x25519.utils.randomPrivateKey(),n=Jr.x25519.getPublicKey(o),s=La(t),i=Jr.x25519.getSharedSecret(o,s),a=await Zr.default.subtle.importKey("raw",i,{name:"AES-GCM",length:256},!0,["encrypt"]),l=Zr.default.getRandomValues(new Uint8Array(12)),f=await Zr.default.subtle.encrypt({name:"AES-GCM",iv:l},a,new TextEncoder().encode(r)),m=new Uint8Array(n.length+l.length+f.byteLength);return m.set(n),m.set(l,n.length),m.set(new Uint8Array(f),n.length+l.length),Ra(m)}});var jn=X(Bt=>{"use strict";var za=Bt&&Bt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Bt,"__esModule",{value:!0});Bt.getComposeHash=ja;var Fa=za(Ce("crypto"));function Qr(e){return e==null?e:Array.isArray(e)?e.map(Qr):e&&typeof e=="object"&&e.constructor===Object?Object.keys(e).sort().reduce((t,r)=>{let o=e[r];return t[r]=Qr(o),t},{}):e}function Ha(e){let t={...e};return t.runner==="bash"&&"docker_compose_file"in t?delete t.docker_compose_file:t.runner==="docker-compose"&&"bash_script"in t&&delete t.bash_script,"pre_launch_script"in t&&!t.pre_launch_script&&delete t.pre_launch_script,t}function Oa(e){let t=Qr(e);return JSON.stringify(t,(r,o)=>typeof o=="number"&&(isNaN(o)||!isFinite(o))?null:o)}function ja(e,t=!1){t&&(e=Ha(e));let r=Oa(e);return Fa.default.createHash("sha256").update(r,"utf8").digest("hex")}});var cs=X(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.toBig=y.shrSL=y.shrSH=y.rotrSL=y.rotrSH=y.rotrBL=y.rotrBH=y.rotr32L=y.rotr32H=y.rotlSL=y.rotlSH=y.rotlBL=y.rotlBH=y.add5L=y.add5H=y.add4L=y.add4H=y.add3L=y.add3H=void 0;y.add=ts;y.fromBig=to;y.split=Nn;var xr=BigInt(2**32-1),eo=BigInt(32);function to(e,t=!1){return t?{h:Number(e&xr),l:Number(e>>eo&xr)}:{h:Number(e>>eo&xr)|0,l:Number(e&xr)|0}}function Nn(e,t=!1){let r=e.length,o=new Uint32Array(r),n=new Uint32Array(r);for(let s=0;s<r;s++){let{h:i,l:a}=to(e[s],t);[o[s],n[s]]=[i,a]}return[o,n]}var qn=(e,t)=>BigInt(e>>>0)<<eo|BigInt(t>>>0);y.toBig=qn;var Mn=(e,t,r)=>e>>>r;y.shrSH=Mn;var Gn=(e,t,r)=>e<<32-r|t>>>r;y.shrSL=Gn;var Dn=(e,t,r)=>e>>>r|t<<32-r;y.rotrSH=Dn;var Vn=(e,t,r)=>e<<32-r|t>>>r;y.rotrSL=Vn;var Kn=(e,t,r)=>e<<64-r|t>>>r-32;y.rotrBH=Kn;var Wn=(e,t,r)=>e>>>r-32|t<<64-r;y.rotrBL=Wn;var Xn=(e,t)=>t;y.rotr32H=Xn;var Jn=(e,t)=>e;y.rotr32L=Jn;var Zn=(e,t,r)=>e<<r|t>>>32-r;y.rotlSH=Zn;var Yn=(e,t,r)=>t<<r|e>>>32-r;y.rotlSL=Yn;var Qn=(e,t,r)=>t<<r-32|e>>>64-r;y.rotlBH=Qn;var es=(e,t,r)=>e<<r-32|t>>>64-r;y.rotlBL=es;function ts(e,t,r,o){let n=(t>>>0)+(o>>>0);return{h:e+r+(n/2**32|0)|0,l:n|0}}var rs=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);y.add3L=rs;var os=(e,t,r,o)=>t+r+o+(e/2**32|0)|0;y.add3H=os;var ns=(e,t,r,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(o>>>0);y.add4L=ns;var ss=(e,t,r,o,n)=>t+r+o+n+(e/2**32|0)|0;y.add4H=ss;var is=(e,t,r,o,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(o>>>0)+(n>>>0);y.add5L=is;var as=(e,t,r,o,n,s)=>t+r+o+n+s+(e/2**32|0)|0;y.add5H=as;var Na={fromBig:to,split:Nn,toBig:qn,shrSH:Mn,shrSL:Gn,rotrSH:Dn,rotrSL:Vn,rotrBH:Kn,rotrBL:Wn,rotr32H:Xn,rotr32L:Jn,rotlSH:Zn,rotlSL:Yn,rotlBH:Qn,rotlBL:es,add:ts,add3L:rs,add3H:os,add4L:ns,add4H:ss,add5H:as,add5L:is};y.default=Na});var ls=X(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.crypto=void 0;var Re=Ce("crypto");gr.crypto=Re&&typeof Re=="object"&&"webcrypto"in Re?Re.webcrypto:Re&&typeof Re=="object"&&"randomBytes"in Re?Re:void 0});var gs=X(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.wrapXOFConstructorWithOpts=x.wrapConstructorWithOpts=x.wrapConstructor=x.Hash=x.nextTick=x.swap32IfBE=x.byteSwapIfBE=x.swap8IfBE=x.isLE=void 0;x.isBytes=us;x.anumber=ro;x.abytes=ct;x.ahash=qa;x.aexists=Ma;x.aoutput=Ga;x.u8=Da;x.u32=Va;x.clean=Ka;x.createView=Wa;x.rotr=Xa;x.rotl=Ja;x.byteSwap=no;x.byteSwap32=fs;x.bytesToHex=Ya;x.hexToBytes=Qa;x.asyncLoop=tc;x.utf8ToBytes=so;x.bytesToUtf8=rc;x.toBytes=br;x.kdfInputToBytes=oc;x.concatBytes=nc;x.checkOpts=sc;x.createHasher=ds;x.createOptHasher=hs;x.createXOFer=xs;x.randomBytes=ic;var at=ls();function us(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ro(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function ct(e,...t){if(!us(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function qa(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ro(e.outputLen),ro(e.blockLen)}function Ma(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ga(e,t){ct(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Da(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function Va(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Ka(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Wa(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Xa(e,t){return e<<32-t|e>>>t}function Ja(e,t){return e<<t|e>>>32-t>>>0}x.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function no(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}x.swap8IfBE=x.isLE?e=>e:e=>no(e);x.byteSwapIfBE=x.swap8IfBE;function fs(e){for(let t=0;t<e.length;t++)e[t]=no(e[t]);return e}x.swap32IfBE=x.isLE?e=>e:fs;var ms=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Za=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Ya(e){if(ct(e),ms)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=Za[e[r]];return t}var Se={_0:48,_9:57,A:65,F:70,a:97,f:102};function ps(e){if(e>=Se._0&&e<=Se._9)return e-Se._0;if(e>=Se.A&&e<=Se.F)return e-(Se.A-10);if(e>=Se.a&&e<=Se.f)return e-(Se.a-10)}function Qa(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(ms)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let o=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){let i=ps(e.charCodeAt(s)),a=ps(e.charCodeAt(s+1));if(i===void 0||a===void 0){let l=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+s)}o[n]=i*16+a}return o}var ec=async()=>{};x.nextTick=ec;async function tc(e,t,r){let o=Date.now();for(let n=0;n<e;n++){r(n);let s=Date.now()-o;s>=0&&s<t||(await(0,x.nextTick)(),o+=s)}}function so(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function rc(e){return new TextDecoder().decode(e)}function br(e){return typeof e=="string"&&(e=so(e)),ct(e),e}function oc(e){return typeof e=="string"&&(e=so(e)),ct(e),e}function nc(...e){let t=0;for(let o=0;o<e.length;o++){let n=e[o];ct(n),t+=n.length}let r=new Uint8Array(t);for(let o=0,n=0;o<e.length;o++){let s=e[o];r.set(s,n),n+=s.length}return r}function sc(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(e,t)}var oo=class{};x.Hash=oo;function ds(e){let t=o=>e().update(br(o)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function hs(e){let t=(o,n)=>e(n).update(br(o)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=o=>e(o),t}function xs(e){let t=(o,n)=>e(n).update(br(o)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=o=>e(o),t}x.wrapConstructor=ds;x.wrapConstructorWithOpts=hs;x.wrapXOFConstructorWithOpts=xs;function ic(e=32){if(at.crypto&&typeof at.crypto.getRandomValues=="function")return at.crypto.getRandomValues(new Uint8Array(e));if(at.crypto&&typeof at.crypto.randomBytes=="function")return Uint8Array.from(at.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}});var Es=X(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.shake256=A.shake128=A.keccak_512=A.keccak_384=A.keccak_256=A.keccak_224=A.sha3_512=A.sha3_384=A.sha3_256=A.sha3_224=A.Keccak=void 0;A.keccakP=ks;var Lt=cs(),q=gs(),ac=BigInt(0),$t=BigInt(1),cc=BigInt(2),lc=BigInt(7),pc=BigInt(256),uc=BigInt(113),vs=[],ws=[],_s=[];for(let e=0,t=$t,r=1,o=0;e<24;e++){[r,o]=[o,(2*r+3*o)%5],vs.push(2*(5*o+r)),ws.push((e+1)*(e+2)/2%64);let n=ac;for(let s=0;s<7;s++)t=(t<<$t^(t>>lc)*uc)%pc,t&cc&&(n^=$t<<($t<<BigInt(s))-$t);_s.push(n)}var Cs=(0,Lt.split)(_s,!0),fc=Cs[0],mc=Cs[1],bs=(e,t,r)=>r>32?(0,Lt.rotlBH)(e,t,r):(0,Lt.rotlSH)(e,t,r),ys=(e,t,r)=>r>32?(0,Lt.rotlBL)(e,t,r):(0,Lt.rotlSL)(e,t,r);function ks(e,t=24){let r=new Uint32Array(10);for(let o=24-t;o<24;o++){for(let i=0;i<10;i++)r[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){let a=(i+8)%10,l=(i+2)%10,f=r[l],m=r[l+1],p=bs(f,m,1)^r[a],d=ys(f,m,1)^r[a+1];for(let h=0;h<50;h+=10)e[i+h]^=p,e[i+h+1]^=d}let n=e[2],s=e[3];for(let i=0;i<24;i++){let a=ws[i],l=bs(n,s,a),f=ys(n,s,a),m=vs[i];n=e[m],s=e[m+1],e[m]=l,e[m+1]=f}for(let i=0;i<50;i+=10){for(let a=0;a<10;a++)r[a]=e[i+a];for(let a=0;a<10;a++)e[i+a]^=~r[(a+2)%10]&r[(a+4)%10]}e[0]^=fc[o],e[1]^=mc[o]}(0,q.clean)(r)}var Rt=class e extends q.Hash{constructor(t,r,o,n=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=r,this.outputLen=o,this.enableXOF=n,this.rounds=s,(0,q.anumber)(o),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,q.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,q.swap32IfBE)(this.state32),ks(this.state32,this.rounds),(0,q.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(t){(0,q.aexists)(this),t=(0,q.toBytes)(t),(0,q.abytes)(t);let{blockLen:r,state:o}=this,n=t.length;for(let s=0;s<n;){let i=Math.min(r-this.pos,n-s);for(let a=0;a<i;a++)o[this.pos++]^=t[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:o,blockLen:n}=this;t[o]^=r,(r&128)!==0&&o===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){(0,q.aexists)(this,!1),(0,q.abytes)(t),this.finish();let r=this.state,{blockLen:o}=this;for(let n=0,s=t.length;n<s;){this.posOut>=o&&this.keccak();let i=Math.min(o-this.posOut,s-n);t.set(r.subarray(this.posOut,this.posOut+i),n),this.posOut+=i,n+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,q.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,q.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,q.clean)(this.state)}_cloneInto(t){let{blockLen:r,suffix:o,outputLen:n,rounds:s,enableXOF:i}=this;return t||(t=new e(r,o,n,i,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=o,t.outputLen=n,t.enableXOF=i,t.destroyed=this.destroyed,t}};A.Keccak=Rt;var Ue=(e,t,r)=>(0,q.createHasher)(()=>new Rt(t,e,r));A.sha3_224=Ue(6,144,224/8);A.sha3_256=Ue(6,136,256/8);A.sha3_384=Ue(6,104,384/8);A.sha3_512=Ue(6,72,512/8);A.keccak_224=Ue(1,144,224/8);A.keccak_256=Ue(1,136,256/8);A.keccak_384=Ue(1,104,384/8);A.keccak_512=Ue(1,72,512/8);var Ts=(e,t,r)=>(0,q.createXOFer)((o={})=>new Rt(t,e,o.dkLen===void 0?r:o.dkLen,!0));A.shake128=Ts(31,168,128/8);A.shake256=Ts(31,136,256/8)});var Ss=X(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});io.verifyEnvEncryptPublicKey=xc;var dc=Es(),hc=Ce("@noble/curves/secp256k1");function xc(e,t,r){if(t.length!==65)return null;let o=Buffer.from("dstack-env-encrypt-pubkey","utf8"),n=r;r.startsWith("0x")&&(n=r.slice(2));let s=Buffer.from(n,"hex"),i=Buffer.from(":","utf8"),a=Buffer.concat([o,i,s,Buffer.from(e)]),l=(0,dc.keccak_256)(a);try{let f=t.slice(0,32),m=t.slice(32,64),p=t[64],d=new Uint8Array(64);d.set(f,0),d.set(m,32);let h=hc.secp256k1.Signature.fromCompact(d).addRecoveryBit(p).recoverPublicKey(l);return"0x"+Buffer.from(h.toRawBytes(!0)).toString("hex")}catch(f){return console.error("signature verification failed:",f),null}}});var $s=xt(Ao(),1);import{ofetch as gc}from"ofetch";function Po(e){return{all:e=e||new Map,on:function(t,r){var o=e.get(t);o?o.push(r):e.set(t,[r])},off:function(t,r){var o=e.get(t);o&&(r?o.splice(o.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var o=e.get(t);o&&o.slice().map(function(n){n(r)}),(o=e.get("*"))&&o.slice().map(function(n){n(t,r)})}}}import{z as H}from"zod";import{z as ze}from"zod";import{z as w}from"zod";import{z as Fe}from"zod";function qe(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}Mt();Me();Mt();var $r={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function wt(e,t){let r={...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,chainId:e.chainId?De(e.chainId):void 0,gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,maxFeePerBlobGas:e.maxFeePerBlobGas?BigInt(e.maxFeePerBlobGas):void 0,maxFeePerGas:e.maxFeePerGas?BigInt(e.maxFeePerGas):void 0,maxPriorityFeePerGas:e.maxPriorityFeePerGas?BigInt(e.maxPriorityFeePerGas):void 0,nonce:e.nonce?De(e.nonce):void 0,to:e.to?e.to:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,type:e.type?$r[e.type]:void 0,typeHex:e.type?e.type:void 0,value:e.value?BigInt(e.value):void 0,v:e.v?BigInt(e.v):void 0};return e.authorizationList&&(r.authorizationList=Vi(e.authorizationList)),r.yParity=(()=>{if(e.yParity)return Number(e.yParity);if(typeof r.v=="bigint"){if(r.v===0n||r.v===27n)return 0;if(r.v===1n||r.v===28n)return 1;if(r.v>=35n)return r.v%2n===0n?1:0}})(),r.type==="legacy"&&(delete r.accessList,delete r.maxFeePerBlobGas,delete r.maxFeePerGas,delete r.maxPriorityFeePerGas,delete r.yParity),r.type==="eip2930"&&(delete r.maxFeePerBlobGas,delete r.maxFeePerGas,delete r.maxPriorityFeePerGas),r.type==="eip1559"&&delete r.maxFeePerBlobGas,r}var Uo=tt("transaction",wt);function Vi(e){return e.map(t=>({address:t.address,chainId:Number(t.chainId),nonce:Number(t.nonce),r:t.r,s:t.s,yParity:Number(t.yParity)}))}function Ki(e,t){let r=(e.transactions??[]).map(o=>typeof o=="string"?o:wt(o));return{...e,baseFeePerGas:e.baseFeePerGas?BigInt(e.baseFeePerGas):null,blobGasUsed:e.blobGasUsed?BigInt(e.blobGasUsed):void 0,difficulty:e.difficulty?BigInt(e.difficulty):void 0,excessBlobGas:e.excessBlobGas?BigInt(e.excessBlobGas):void 0,gasLimit:e.gasLimit?BigInt(e.gasLimit):void 0,gasUsed:e.gasUsed?BigInt(e.gasUsed):void 0,hash:e.hash?e.hash:null,logsBloom:e.logsBloom?e.logsBloom:null,nonce:e.nonce?e.nonce:null,number:e.number?BigInt(e.number):null,size:e.size?BigInt(e.size):void 0,timestamp:e.timestamp?BigInt(e.timestamp):void 0,transactions:r,totalDifficulty:e.totalDifficulty?BigInt(e.totalDifficulty):null}}var zo=tt("block",Ki);function Fo(e,{args:t,eventName:r}={}){return{...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,logIndex:e.logIndex?Number(e.logIndex):null,transactionHash:e.transactionHash?e.transactionHash:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,...r?{args:t,eventName:r}:{}}}Me();Mt();var Wi={"0x0":"reverted","0x1":"success"};function Xi(e,t){let r={...e,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,contractAddress:e.contractAddress?e.contractAddress:null,cumulativeGasUsed:e.cumulativeGasUsed?BigInt(e.cumulativeGasUsed):null,effectiveGasPrice:e.effectiveGasPrice?BigInt(e.effectiveGasPrice):null,gasUsed:e.gasUsed?BigInt(e.gasUsed):null,logs:e.logs?e.logs.map(o=>Fo(o)):null,to:e.to?e.to:null,transactionIndex:e.transactionIndex?De(e.transactionIndex):null,status:e.status?Wi[e.status]:null,type:e.type?$r[e.type]||e.type:null};return e.blobGasPrice&&(r.blobGasPrice=BigInt(e.blobGasPrice)),e.blobGasUsed&&(r.blobGasUsed=BigInt(e.blobGasUsed)),r}var Ho=tt("transactionReceipt",Xi);ne();Rr();Be();ie();function Te(e,t="hex"){let r=No(e),o=Kt(new Uint8Array(r.length));return r.encode(o),t==="hex"?Z(o.bytes):o.bytes}function No(e){return Array.isArray(e)?Zi(e.map(t=>No(t))):Yi(e)}function Zi(e){let t=e.reduce((n,s)=>n+s.length,0),r=qo(t);return{length:t<=55?1+t:1+r+t,encode(n){t<=55?n.pushByte(192+t):(n.pushByte(247+r),r===1?n.pushUint8(t):r===2?n.pushUint16(t):r===3?n.pushUint24(t):n.pushUint32(t));for(let{encode:s}of e)s(n)}}}function Yi(e){let t=typeof e=="string"?ue(e):e,r=qo(t.length);return{length:t.length===1&&t[0]<128?1:t.length<=55?1+t.length:1+r+t.length,encode(n){t.length===1&&t[0]<128?n.pushBytes(t):t.length<=55?(n.pushByte(128+t.length),n.pushBytes(t)):(n.pushByte(183+r),r===1?n.pushUint8(t.length):r===2?n.pushUint16(t.length):r===3?n.pushUint24(t.length):n.pushUint32(t.length),n.pushBytes(t))}}}function qo(e){if(e<2**8)return 1;if(e<2**16)return 2;if(e<2**24)return 3;if(e<2**32)return 4;throw new b("Length is too large.")}Zt();ie();function Wo(e){if(!e||e.length===0)return[];let t=[];for(let r of e){let{chainId:o,nonce:n,...s}=r,i=r.address;t.push([o?pe(o):"0x",i,n?pe(n):"0x",...rt({},s)])}return t}Be();ie();function Yt(e){let{kzg:t}=e,r=e.to??(typeof e.blobs[0]=="string"?"hex":"bytes"),o=typeof e.blobs[0]=="string"?e.blobs.map(s=>ue(s)):e.blobs,n=[];for(let s of o)n.push(Uint8Array.from(t.blobToKzgCommitment(s)));return r==="bytes"?n:n.map(s=>Z(s))}Be();ie();function Qt(e){let{kzg:t}=e,r=e.to??(typeof e.blobs[0]=="string"?"hex":"bytes"),o=typeof e.blobs[0]=="string"?e.blobs.map(i=>ue(i)):e.blobs,n=typeof e.commitments[0]=="string"?e.commitments.map(i=>ue(i)):e.commitments,s=[];for(let i=0;i<o.length;i++){let a=o[i],l=n[i];s.push(Uint8Array.from(t.computeBlobKzgProof(a,l)))}return r==="bytes"?s:s.map(i=>Z(i))}ie();or();function sa(e,t,r,o){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,o);let n=BigInt(32),s=BigInt(4294967295),i=Number(r>>n&s),a=Number(r&s),l=o?4:0,f=o?0:4;e.setUint32(t+l,i,o),e.setUint32(t+f,a,o)}function Jo(e,t,r){return e&t^~e&r}function Zo(e,t,r){return e&t^e&r^t&r}var nr=class extends ot{constructor(t,r,o,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=o,this.isLE=n,this.buffer=new Uint8Array(t),this.view=tr(this.buffer)}update(t){nt(this),t=kt(t),Ke(t);let{view:r,buffer:o,blockLen:n}=this,s=t.length;for(let i=0;i<s;){let a=Math.min(n-this.pos,s-i);if(a===n){let l=tr(t);for(;n<=s-i;i+=n)this.process(l,i);continue}o.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){nt(this),er(t,this),this.finished=!0;let{buffer:r,view:o,blockLen:n,isLE:s}=this,{pos:i}=this;r[i++]=128,$e(this.buffer.subarray(i)),this.padOffset>n-i&&(this.process(o,0),i=0);for(let p=i;p<n;p++)r[p]=0;sa(o,n-8,BigInt(this.length*8),s),this.process(o,0);let a=tr(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=l/4,m=this.get();if(f>m.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<f;p++)a.setUint32(4*p,m[p],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let o=t.slice(0,r);return this.destroy(),o}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:o,length:n,finished:s,destroyed:i,pos:a}=this;return t.destroyed=i,t.finished=s,t.length=n,t.pos=a,n%r&&t.buffer.set(o),t}clone(){return this._cloneInto()}},Ee=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);or();var aa=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Le=new Uint32Array(64),ir=class extends nr{constructor(t=32){super(64,t,8,!1),this.A=Ee[0]|0,this.B=Ee[1]|0,this.C=Ee[2]|0,this.D=Ee[3]|0,this.E=Ee[4]|0,this.F=Ee[5]|0,this.G=Ee[6]|0,this.H=Ee[7]|0}get(){let{A:t,B:r,C:o,D:n,E:s,F:i,G:a,H:l}=this;return[t,r,o,n,s,i,a,l]}set(t,r,o,n,s,i,a,l){this.A=t|0,this.B=r|0,this.C=o|0,this.D=n|0,this.E=s|0,this.F=i|0,this.G=a|0,this.H=l|0}process(t,r){for(let p=0;p<16;p++,r+=4)Le[p]=t.getUint32(r,!1);for(let p=16;p<64;p++){let d=Le[p-15],h=Le[p-2],I=fe(d,7)^fe(d,18)^d>>>3,T=fe(h,17)^fe(h,19)^h>>>10;Le[p]=T+Le[p-7]+I+Le[p-16]|0}let{A:o,B:n,C:s,D:i,E:a,F:l,G:f,H:m}=this;for(let p=0;p<64;p++){let d=fe(a,6)^fe(a,11)^fe(a,25),h=m+d+Jo(a,l,f)+aa[p]+Le[p]|0,T=(fe(o,2)^fe(o,13)^fe(o,22))+Zo(o,n,s)|0;m=f,f=l,l=a,a=i+h|0,i=s,s=n,n=o,o=h+T|0}o=o+this.A|0,n=n+this.B|0,s=s+this.C|0,i=i+this.D|0,a=a+this.E|0,l=l+this.F|0,f=f+this.G|0,m=m+this.H|0,this.set(o,n,s,i,a,l,f,m)}roundClean(){$e(Le)}destroy(){this.set(0,0,0,0,0,0,0,0),$e(this.buffer)}};var sn=rr(()=>new ir);var an=sn;et();Be();ie();function cn(e,t){let r=t||"hex",o=an(he(e,{strict:!1})?qt(e):e);return r==="bytes"?o:pe(o)}function ln(e){let{commitment:t,version:r=1}=e,o=e.to??(typeof t=="string"?"hex":"bytes"),n=cn(t,"bytes");return n.set([r],0),o==="bytes"?n:Z(n)}function pn(e){let{commitments:t,version:r}=e,o=e.to??(typeof t[0]=="string"?"hex":"bytes"),n=[];for(let s of t)n.push(ln({commitment:s,to:o,version:r}));return n}ne();var ar=class extends b{constructor({maxSize:t,size:r}){super("Blob size is too large.",{metaMessages:[`Max: ${t} bytes`,`Given: ${r} bytes`],name:"BlobSizeTooLargeError"})}},st=class extends b{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}},cr=class extends b{constructor({hash:t,size:r}){super(`Versioned hash "${t}" size is invalid.`,{metaMessages:["Expected: 32",`Received: ${r}`],name:"InvalidVersionedHashSizeError"})}},lr=class extends b{constructor({hash:t,version:r}){super(`Versioned hash "${t}" version is invalid.`,{metaMessages:[`Expected: ${1}`,`Received: ${r}`],name:"InvalidVersionedHashVersionError"})}};Rr();gt();Be();ie();function un(e){let t=e.to??(typeof e.data=="string"?"hex":"bytes"),r=typeof e.data=="string"?ue(e.data):e.data,o=se(r);if(!o)throw new st;if(o>761855)throw new ar({maxSize:761855,size:o});let n=[],s=!0,i=0;for(;s;){let a=Kt(new Uint8Array(131072)),l=0;for(;l<4096;){let f=r.slice(i,i+31);if(a.pushByte(0),a.pushBytes(f),f.length<31){a.pushByte(128),s=!1;break}l++,i+=31}n.push(a)}return t==="bytes"?n.map(a=>a.bytes):n.map(a=>Z(a.bytes))}function fn(e){let{data:t,kzg:r,to:o}=e,n=e.blobs??un({data:t,to:o}),s=e.commitments??Yt({blobs:n,kzg:r,to:o}),i=e.proofs??Qt({blobs:n,commitments:s,kzg:r,to:o}),a=[];for(let l=0;l<n.length;l++)a.push({blob:n[l],commitment:s[l],proof:i[l]});return a}Lr();Lo();ie();Oo();pr();ne();mn();dn();fr();gt();Pn();Me();function Bn(e){let{authorizationList:t}=e;if(t)for(let r of t){let{chainId:o}=r,n=r.address;if(!xe(n))throw new ae({address:n});if(o<0)throw new We({chainId:o})}mr(e)}function $n(e){let{blobVersionedHashes:t}=e;if(t){if(t.length===0)throw new st;for(let r of t){let o=se(r),n=De(Sn(r,0,1));if(o!==32)throw new cr({hash:r,size:o});if(n!==1)throw new lr({hash:r,version:n})}}mr(e)}function mr(e){let{chainId:t,maxPriorityFeePerGas:r,maxFeePerGas:o,to:n}=e;if(t<=0)throw new We({chainId:t});if(n&&!xe(n))throw new ae({address:n});if(o&&o>Gt)throw new Xe({maxFeePerGas:o});if(r&&o&&r>o)throw new Tt({maxFeePerGas:o,maxPriorityFeePerGas:r})}function Ln(e){let{chainId:t,maxPriorityFeePerGas:r,gasPrice:o,maxFeePerGas:n,to:s}=e;if(t<=0)throw new We({chainId:t});if(s&&!xe(s))throw new ae({address:s});if(r||n)throw new b("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid EIP-2930 Transaction attribute.");if(o&&o>Gt)throw new Xe({maxFeePerGas:o})}function Rn(e){let{chainId:t,maxPriorityFeePerGas:r,gasPrice:o,maxFeePerGas:n,to:s}=e;if(s&&!xe(s))throw new ae({address:s});if(typeof t<"u"&&t<=0)throw new We({chainId:t});if(r||n)throw new b("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid Legacy Transaction attribute.");if(o&&o>Gt)throw new Xe({maxFeePerGas:o})}Zt();function Un(e){if(e.type)return e.type;if(typeof e.authorizationList<"u")return"eip7702";if(typeof e.blobs<"u"||typeof e.blobVersionedHashes<"u"||typeof e.maxFeePerBlobGas<"u"||typeof e.sidecars<"u")return"eip4844";if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")return"eip1559";if(typeof e.gasPrice<"u")return typeof e.accessList<"u"?"eip2930":"legacy";throw new Xt({transaction:e})}pr();Zt();fr();function St(e){if(!e||e.length===0)return[];let t=[];for(let r=0;r<e.length;r++){let{address:o,storageKeys:n}=e[r];for(let s=0;s<n.length;s++)if(n[s].length-2!==64)throw new Jt({storageKey:n[s]});if(!xe(o,{strict:!1}))throw new ae({address:o});t.push([o,n])}return t}function zn(e,t){let r=Un(e);return r==="eip1559"?ka(e,t):r==="eip2930"?Ta(e,t):r==="eip4844"?Ca(e,t):r==="eip7702"?_a(e,t):Ea(e,t)}function _a(e,t){let{authorizationList:r,chainId:o,gas:n,nonce:s,to:i,value:a,maxFeePerGas:l,maxPriorityFeePerGas:f,accessList:m,data:p}=e;Bn(e);let d=St(m),h=Wo(r);return Ve(["0x04",Te([_(o),s?_(s):"0x",f?_(f):"0x",l?_(l):"0x",n?_(n):"0x",i??"0x",a?_(a):"0x",p??"0x",d,h,...rt(e,t)])])}function Ca(e,t){let{chainId:r,gas:o,nonce:n,to:s,value:i,maxFeePerBlobGas:a,maxFeePerGas:l,maxPriorityFeePerGas:f,accessList:m,data:p}=e;$n(e);let d=e.blobVersionedHashes,h=e.sidecars;if(e.blobs&&(typeof d>"u"||typeof h>"u")){let O=typeof e.blobs[0]=="string"?e.blobs:e.blobs.map(re=>Z(re)),ee=e.kzg,le=Yt({blobs:O,kzg:ee});if(typeof d>"u"&&(d=pn({commitments:le})),typeof h>"u"){let re=Qt({blobs:O,commitments:le,kzg:ee});h=fn({blobs:O,commitments:le,proofs:re})}}let I=St(m),T=[_(r),n?_(n):"0x",f?_(f):"0x",l?_(l):"0x",o?_(o):"0x",s??"0x",i?_(i):"0x",p??"0x",I,a?_(a):"0x",d??[],...rt(e,t)],P=[],K=[],W=[];if(h)for(let O=0;O<h.length;O++){let{blob:ee,commitment:le,proof:re}=h[O];P.push(ee),K.push(le),W.push(re)}return Ve(["0x03",h?Te([T,P,K,W]):Te(T)])}function ka(e,t){let{chainId:r,gas:o,nonce:n,to:s,value:i,maxFeePerGas:a,maxPriorityFeePerGas:l,accessList:f,data:m}=e;mr(e);let p=St(f),d=[_(r),n?_(n):"0x",l?_(l):"0x",a?_(a):"0x",o?_(o):"0x",s??"0x",i?_(i):"0x",m??"0x",p,...rt(e,t)];return Ve(["0x02",Te(d)])}function Ta(e,t){let{chainId:r,gas:o,data:n,nonce:s,to:i,value:a,accessList:l,gasPrice:f}=e;Ln(e);let m=St(l),p=[_(r),s?_(s):"0x",f?_(f):"0x",o?_(o):"0x",i??"0x",a?_(a):"0x",n??"0x",m,...rt(e,t)];return Ve(["0x01",Te(p)])}function Ea(e,t){let{chainId:r=0,gas:o,data:n,nonce:s,to:i,value:a,gasPrice:l}=e;Rn(e);let f=[s?_(s):"0x",l?_(l):"0x",o?_(o):"0x",i??"0x",a?_(a):"0x",n??"0x"];if(t){let m=(()=>{if(t.v>=35n)return(t.v-35n)/2n>0?t.v:27n+(t.v===35n?0n:1n);if(r>0)return BigInt(r*2)+BigInt(35n+t.v-27n);let h=27n+(t.v===27n?0n:1n);if(t.v!==h)throw new Wt({v:t.v});return h})(),p=bt(t.r),d=bt(t.s);f=[...f,_(m),p==="0x00"?"0x":p,d==="0x00"?"0x":d]}else r>0&&(f=[...f,_(r),"0x","0x"]);return Te(f)}function rt(e,t){let r=t??e,{v:o,yParity:n}=r;if(typeof r.r>"u")return[];if(typeof r.s>"u")return[];if(typeof o>"u"&&typeof n>"u")return[];let s=bt(r.r),i=bt(r.s);return[typeof n=="number"?n?_(1):"0x":o===0n?"0x":o===1n?_(1):o===27n?"0x":_(1),s==="0x00"?"0x":s,i==="0x00"?"0x":i]}var Fn={gasPriceOracle:{address:"0x420000000000000000000000000000000000000F"},l1Block:{address:"0x4200000000000000000000000000000000000015"},l2CrossDomainMessenger:{address:"0x4200000000000000000000000000000000000007"},l2Erc721Bridge:{address:"0x4200000000000000000000000000000000000014"},l2StandardBridge:{address:"0x4200000000000000000000000000000000000010"},l2ToL1MessagePasser:{address:"0x4200000000000000000000000000000000000016"}};Me();var Hn={block:zo({format(e){return{transactions:e.transactions?.map(r=>{if(typeof r=="string")return r;let o=wt(r);return o.typeHex==="0x7e"&&(o.isSystemTx=r.isSystemTx,o.mint=r.mint?Ge(r.mint):void 0,o.sourceHash=r.sourceHash,o.type="deposit"),o}),stateRoot:e.stateRoot}}}),transaction:Uo({format(e){let t={};return e.type==="0x7e"&&(t.isSystemTx=e.isSystemTx,t.mint=e.mint?Ge(e.mint):void 0,t.sourceHash=e.sourceHash,t.type="deposit"),t}}),transactionReceipt:Ho({format(e){return{l1GasPrice:e.l1GasPrice?Ge(e.l1GasPrice):null,l1GasUsed:e.l1GasUsed?Ge(e.l1GasUsed):null,l1Fee:e.l1Fee?Ge(e.l1Fee):null,l1FeeScalar:e.l1FeeScalar?Number(e.l1FeeScalar):null}}})};pr();fr();Lr();ie();function Sa(e,t){return Aa(e)?Ia(e):zn(e,t)}var On={transaction:Sa};function Ia(e){Pa(e);let{sourceHash:t,data:r,from:o,gas:n,isSystemTx:s,mint:i,to:a,value:l}=e,f=[t,o,a??"0x",i?pe(i):"0x",l?pe(l):"0x",n?pe(n):"0x",s?"0x1":"0x",r??"0x"];return Ve(["0x7e",Te(f)])}function Aa(e){return e.type==="deposit"||typeof e.sourceHash<"u"}function Pa(e){let{from:t,to:r}=e;if(t&&!xe(t))throw new ae({address:t});if(r&&!xe(r))throw new ae({address:r})}var Xr={blockTime:2e3,contracts:Fn,formatters:Hn,serializers:On};var dr=qe({id:31337,name:"Anvil",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},rpcUrls:{default:{http:["http://127.0.0.1:8545"],webSocket:["ws://127.0.0.1:8545"]}}});var It=1,At=qe({...Xr,id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}},contracts:{...Xr.contracts,disputeGameFactory:{[It]:{address:"0x43edB88C4B80fDD2AdFF2412A7BebF9dF42cB40e"}},l2OutputOracle:{[It]:{address:"0x56315b90c40730925ec5485cf004d835058518A0"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:5022},portal:{[It]:{address:"0x49048044D57e1C92A77f79988d21Fa8fAF74E97e",blockCreated:17482143}},l1StandardBridge:{[It]:{address:"0x3154Cf16ccdb4C6d922629664174b904d80F2C35",blockCreated:17482143}}},sourceId:It}),Ba=qe({...At,experimental_preconfirmationTime:200,rpcUrls:{default:{http:["https://mainnet-preconf.base.org"]}}});var hr=qe({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockTime:12e3,rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:23085558},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}});import{z as L}from"zod";import{z as te}from"zod";import{z as u}from"zod";import{z as pt}from"zod";import{z as ce}from"zod";import{z as v}from"zod";import{z as C}from"zod";import{z as G}from"zod";import wl from"crypto";import{z as ye}from"zod";import{z as me}from"zod";import{z as j}from"zod";import{z as Y}from"zod";import{z as Q}from"zod";import{z as Ql}from"zod";import{z as As}from"zod";import{z as ve}from"zod";import{z as mt}from"zod";import{z as Je}from"zod";import{z as Sp}from"zod";import{z as Bp}from"zod";import{z as S}from"zod";import{z as be}from"zod";import{z as Vp}from"zod";import{z as $}from"zod";import{z as g}from"zod";import{z as ft}from"zod";import{z as Ps}from"zod";import{z as M}from"zod";import{z as Ks}from"zod";import{z as ge}from"zod";import{z as U}from"zod";var ug=xt(Yr(),1);import{z as B}from"zod";var $u=xt(Yr(),1),Lu=xt(jn(),1),Ru=xt(Ss(),1);import{z as ut}from"zod";import{z as D}from"zod";var bc=H.object({detail:H.union([H.string(),H.array(H.object({msg:H.string(),type:H.string().optional(),ctx:H.record(H.unknown()).optional(),loc:H.array(H.union([H.string(),H.number()])).optional(),input:H.unknown().optional()}).passthrough()),H.record(H.unknown())]).optional(),type:H.string().optional(),code:H.string().optional()}),we=class extends Error{constructor(e,t){super(e),this.name=this.constructor.name,this.status=t.status,this.statusText=t.statusText,this.detail=t.detail,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},ao=class yr extends we{constructor(t,r){super(t,{status:r?.status??0,statusText:r?.statusText??"Unknown Error",detail:r?.detail||t}),this.name="RequestError",this.isRequestError=!0,this.data=r?.data,this.request=r?.request,this.response=r?.response,this.code=r?.code,this.type=r?.type}static fromFetchError(t){let r=bc.safeParse(t.data);return r.success?new yr(t.message,{status:t.status??void 0,statusText:t.statusText??void 0,data:t.data,request:t.request??void 0,response:t.response??void 0,detail:r.data.detail,code:r.data.code??void 0,type:r.data.type??void 0}):new yr(t.message,{status:t.status??void 0,statusText:t.statusText??void 0,data:t.data,request:t.request??void 0,response:t.response??void 0,detail:t.data?.detail||"Unknown API error",code:t.status?.toString()??void 0})}static fromError(t,r){return new yr(t.message,{request:r??void 0,detail:t.message})}},yc=class extends we{constructor(e,t){super(e,t),this.isValidationError=!0,this.validationErrors=t.validationErrors}},vc=class extends we{constructor(){super(...arguments),this.isAuthError=!0}},Ls=class extends we{constructor(){super(...arguments),this.isBusinessError=!0}},wc=class extends we{constructor(){super(...arguments),this.isServerError=!0}},_c=class extends we{constructor(){super(...arguments),this.isUnknownError=!0}};function Cc(e){if(!e||!Array.isArray(e))return"unknown";let t=e.filter(r=>typeof r=="string"?!["body","query","path","header"].includes(r):!0);return t.length>0?t.join("."):"unknown"}function Rs(e){if(!Array.isArray(e))return{errors:[],message:typeof e=="string"?e:"Validation error"};let t=e.map((n,s)=>{let i=Cc(n.loc),a=i;return i==="unknown"&&n.type&&(a=n.type==="missing"?"required field":n.type),{field:a,message:n.msg,type:n.type,context:n.ctx}}),r=t.length,o=r===1?`Validation failed: ${t[0].message}`:`Validation failed (${r} issue${r>1?"s":""})`;return{errors:t,message:o}}function kc(e){return e===422?"validation":e===401||e===403?"auth":e>=400&&e<500?"business":e>=500?"server":"unknown"}function Tc(e,t,r){if(e===422&&Array.isArray(t)){let{message:o}=Rs(t);return o}if(typeof t=="string")return t;if(t&&typeof t=="object"&&"message"in t){let o=t.message;if(typeof o=="string")return o}return r}function Ec(e){let t=e.status??0,r=e.statusText??"Unknown Error",o=e.detail,n=Ic(o);if(n)return new Sc(n.message,{status:t,statusText:r,detail:o,errorCode:n.error_code,structuredDetails:n.details,suggestions:n.suggestions,links:n.links});let s=kc(t),i=Tc(t,o,e.message),a={status:t,statusText:r,detail:o};if(s==="validation"&&Array.isArray(o)){let{errors:l}=Rs(o);return new yc(i,{...a,validationErrors:l})}return s==="auth"?new vc(i,a):s==="business"?new Ls(i,a):s==="server"?new wc(i,a):new _c(i,a)}var Sc=class extends Ls{constructor(e,t){super(e,t),this.isResourceError=!0,this.errorCode=t.errorCode,this.structuredDetails=t.structuredDetails,this.suggestions=t.suggestions,this.links=t.links}};function Ic(e){if(!e||typeof e!="object")return null;let t=e;return t.error_code&&typeof t.error_code=="string"&&t.message&&typeof t.message=="string"?{error_code:t.error_code,message:t.message,details:t.details,suggestions:t.suggestions,links:t.links}:null}var co=["2025-05-31","2025-10-28"],lt=(0,$s.default)("phala::api-client");function Ac(e){return Object.entries(e).map(([t,r])=>`    -H "${t}: ${r}"`).join(`
`)}function Pc(e){return e?`    -d '${(typeof e=="string"?e:JSON.stringify(e,null,2)).replace(/'/g,"\\'")}'`:""}function Is(e,t,r,o){let n=[];r.forEach((a,l)=>{n.push(`${l}: ${a}`)});let s=n.join(`
`),i=typeof o=="string"?o:JSON.stringify(o,null,2);return[`< HTTP/1.1 ${e} ${t}`,s?`< ${s.replace(/\n/g,`
< `)}`:"","",i].filter(Boolean).join(`
`)}var Bc=class{constructor(e={}){this.emitter=Po();let t={...e,apiKey:e.apiKey||process?.env?.PHALA_CLOUD_API_KEY,baseURL:e.baseURL||process?.env?.PHALA_CLOUD_API_PREFIX||"https://cloud-api.phala.network/api/v1"},r=t.version&&co.includes(t.version)?t.version:co[co.length-1];this.config=t;let{apiKey:o,baseURL:n,timeout:s,headers:i,useCookieAuth:a,onResponseError:l,...f}=t,m={"X-Phala-Version":r,"Content-Type":"application/json"};i&&typeof i=="object"&&Object.entries(i).forEach(([p,d])=>{typeof d=="string"&&(m[p]=d)}),!a&&o&&(m["X-API-Key"]=o),this.fetchInstance=gc.create({baseURL:n,timeout:s||3e4,headers:m,...a?{credentials:"include"}:{},...f,onRequest({request:p,options:d}){if(lt.enabled){let h=d.method||"GET",I=typeof p=="string"?p:p.url,T=I.startsWith("http")?I:`${n}${I}`,P={};d.headers&&typeof d.headers=="object"&&Object.entries(d.headers).forEach(([W,O])=>{typeof O=="string"&&(P[W]=O)});let K=[`> curl -X ${h} "${T}"`,Ac(P),d.body?Pc(d.body):""].filter(Boolean).join(`
`);lt(`
=== REQUEST ===
%s
`,K)}},onResponse({request:p,response:d,options:h}){if(lt.enabled){let I=h.method||"GET",T=typeof p=="string"?p:p.url;lt(`
=== RESPONSE [%s %s] (%dms) ===
%s
`,I,T,d.headers.get("x-response-time")||"?",Is(d.status,d.statusText,d.headers,d._data))}},onResponseError:({request:p,response:d,options:h})=>{if(console.warn(`HTTP ${d.status}: ${d.url}`),lt.enabled){let I=h.method||"GET",T=typeof p=="string"?p:p.url;lt(`
=== ERROR RESPONSE [%s %s] ===
%s
`,I,T,Is(d.status,d.statusText,d.headers,d._data))}l&&l({request:p,response:d,options:h})}})}get raw(){return this.fetchInstance}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}once(e,t){let r=o=>{t(o),this.emitter.off(e,r)};this.emitter.on(e,r)}async get(e,t){try{return await this.fetchInstance(e,{...t,method:"GET"})}catch(r){let o=this.convertToRequestError(r);throw this.emitError(o)}}async post(e,t,r){try{return await this.fetchInstance(e,{...r,method:"POST",body:t})}catch(o){let n=this.convertToRequestError(o);throw this.emitError(n)}}async put(e,t,r){try{return await this.fetchInstance(e,{...r,method:"PUT",body:t})}catch(o){let n=this.convertToRequestError(o);throw this.emitError(n)}}async patch(e,t,r){try{return await this.fetchInstance(e,{...r,method:"PATCH",body:t})}catch(o){let n=this.convertToRequestError(o);throw this.emitError(n)}}async delete(e,t){try{return await this.fetchInstance(e,{...t,method:"DELETE"})}catch(r){let o=this.convertToRequestError(r);throw this.emitError(o)}}async request(e,t){let{body:r,...o}=t||{};try{return await this.fetchInstance(e,{...o,body:r})}catch(n){let s=this.convertToRequestError(n);throw this.emitError(s)}}async requestFull(e,t){let{body:r,...o}=t||{},n=await this.fetchInstance.raw(e,{...o,body:r,ignoreResponseError:!0});return{status:n.status,statusText:n.statusText,headers:n.headers,data:n._data,ok:n.ok}}convertToRequestError(e){return e&&typeof e=="object"&&"data"in e?ao.fromFetchError(e):e instanceof Error?ao.fromError(e):new ao("Unknown error occurred",{detail:"Unknown error occurred"})}emitError(e){let t=Ec(e);return this.emitter.emit("error",t),t}async safeRequest(e){try{return{success:!0,data:await e()}}catch(t){if(t instanceof we)return{success:!1,error:t};let r=this.convertToRequestError(t);return this.emitError(r),{success:!1,error:r}}}async safeGet(e,t){return this.safeRequest(()=>this.get(e,t))}async safePost(e,t,r){return this.safeRequest(()=>this.post(e,t,r))}async safePut(e,t,r){return this.safeRequest(()=>this.put(e,t,r))}async safePatch(e,t,r){return this.safeRequest(()=>this.patch(e,t,r))}async safeDelete(e,t){return this.safeRequest(()=>this.delete(e,t))}async safeRequestMethod(e,t){return this.safeRequest(()=>this.request(e,t))}async safeRequestFull(e,t){return this.safeRequest(()=>this.requestFull(e,t))}extend(e){let t=typeof e=="function"?e(this):e,r=Object.create(this);for(let[o,n]of Object.entries(t))typeof n=="function"&&(r[o]=(...s)=>n(this,...s));return r}};function $c(e={}){return new Bc(e)}function Us(e){if(e?.schema!==void 0&&e?.schema!==!1&&(typeof e.schema!="object"||e.schema===null||!("parse"in e.schema)||typeof e.schema.parse!="function"))throw new Error("Invalid schema: must be a Zod schema object, false, or undefined")}function zs(e){if(e?.schema!==void 0&&e?.schema!==!1&&(typeof e.schema!="object"||e.schema===null||!("parse"in e.schema)||typeof e.schema.parse!="function"))return{success:!1,error:{name:"ZodError",message:"Invalid schema: must be a Zod schema object, false, or undefined",issues:[{code:"invalid_type",expected:"object",received:typeof e.schema,path:["schema"],message:"Invalid schema: must be a Zod schema object, false, or undefined"}]}}}function Fs(e,t){function r(i,a){return o(i,a)}async function o(i,a){Us(a);let l=await t(i);return a?.schema===!1?l:(a?.schema||e).parse(l)}function n(i,a){return s(i,a)}async function s(i,a){let l=zs(a);if(l)return l;let f=await(async()=>{try{return{success:!0,data:await t(i)}}catch(p){return p&&typeof p=="object"&&"status"in p?{success:!1,error:p}:p&&typeof p=="object"&&"issues"in p?{success:!1,error:p}:{success:!1,error:{name:"Error",message:p instanceof Error?p.message:String(p)}}}})();return f.success?a?.schema===!1?{success:!0,data:f.data}:(a?.schema||e).safeParse(f.data):f}return{action:r,safeAction:n}}function k(e,t){function r(i,...a){let[l,f]=a;return o(i,l,f)}async function o(i,a,l){Us(l);let f=await t(i,a);return l?.schema===!1?f:(l?.schema||e).parse(f)}function n(i,...a){let[l,f]=a;return s(i,l,f)}async function s(i,a,l){let f=zs(l);if(f)return f;let m=await(async()=>{try{return{success:!0,data:await t(i,a)}}catch(d){return d&&typeof d=="object"&&"status"in d?{success:!1,error:d}:d&&typeof d=="object"&&"issues"in d?{success:!1,error:d}:{success:!1,error:{name:"Error",message:d instanceof Error?d.message:String(d)}}}})();return m.success?l?.schema===!1?{success:!0,data:m.data}:(l?.schema||e).safeParse(m.data):m}return{action:r,safeAction:n}}var Lc=ze.object({username:ze.string(),email:ze.string(),credits:ze.number(),granted_credits:ze.number(),avatar:ze.string(),team_name:ze.string(),team_tier:ze.string()}).passthrough(),{action:Rc,safeAction:Uc}=Fs(Lc,async e=>await e.get("/auth/me")),zc={[hr.id]:hr,[At.id]:At,[dr.id]:dr},Fc=Fe.object({id:Fe.string(),slug:Fe.string().nullable(),url:Fe.string(),version:Fe.string(),chain_id:Fe.number().nullable(),kms_contract_address:Fe.string().nullable().transform(e=>e),gateway_app_id:Fe.string().nullable().transform(e=>e)}).passthrough(),_e=Fc.transform(e=>{if(e.chain_id!=null){let t=zc[e.chain_id];if(t)return{...e,chain:t}}return e}),Hc=w.object({name:w.string(),is_dev:w.boolean(),version:w.union([w.tuple([w.number(),w.number(),w.number()]),w.tuple([w.number(),w.number(),w.number(),w.number()])]),os_image_hash:w.string().nullable().optional()}).passthrough(),Oc=w.object({teepod_id:w.number(),name:w.string(),listed:w.boolean(),resource_score:w.number(),remaining_vcpu:w.number(),remaining_memory:w.number(),remaining_cvm_slots:w.number(),images:w.array(Hc),support_onchain_kms:w.boolean().optional(),fmspc:w.string().nullable().optional(),device_id:w.string().nullable().optional(),region_identifier:w.string().nullable().optional(),default_kms:w.string().nullable().optional(),kms_list:w.array(w.string()).default([])}).passthrough(),jc=w.object({max_instances:w.number().nullable().optional(),max_vcpu:w.number().nullable().optional(),max_memory:w.number().nullable().optional(),max_disk:w.number().nullable().optional()}).passthrough(),Nc=w.object({tier:w.string(),capacity:jc,nodes:w.array(Oc),kms_list:w.array(_e)}).passthrough(),{action:qc,safeAction:Mc}=Fs(Nc,async e=>await e.get("/teepods/available")),Hs=L.object({id:L.string(),name:L.string(),description:L.string(),vcpu:L.number(),memory_mb:L.number(),hourly_rate:L.string(),requires_gpu:L.boolean(),default_disk_size_gb:L.number().default(20),family:L.string().nullable()}).passthrough(),Gc=L.object({name:L.string(),items:L.array(Hs),total:L.number()}).strict(),Dc=L.object({result:L.array(Gc)}).strict(),Vc=L.object({items:L.array(Hs),total:L.number(),family:L.string()}).strict(),Kc=L.object({family:L.string()}).strict(),{action:Wc,safeAction:Xc}=k(Dc,async e=>await e.get("/instance-types")),{action:Jc,safeAction:Zc}=k(Vc,async(e,t)=>{let r=Kc.parse(t);return await e.get(`/instance-types/${r.family}`)}),Os=te.object({id:te.string(),name:te.string(),slug:te.string().nullable(),tier:te.string(),role:te.string(),created_at:te.string()}).passthrough(),Yc=te.object({has_more:te.boolean(),next_cursor:te.string().nullable(),total:te.number().nullable()}).passthrough(),Qc=te.object({data:te.array(Os),pagination:Yc}).passthrough(),{action:el,safeAction:tl}=k(Qc,async(e,t)=>{let r=new URLSearchParams;t?.cursor&&r.append("cursor",t.cursor),t?.limit&&r.append("limit",t.limit.toString());let o=r.toString()?`/workspaces?${r.toString()}`:"/workspaces";return await e.get(o)}),{action:rl,safeAction:ol}=k(Os,async(e,t)=>await e.get(`/workspaces/${t}`)),nl=u.object({id:u.string(),name:u.string(),status:u.string(),uptime:u.string(),app_url:u.string().nullable(),app_id:u.string(),instance_id:u.string().nullable(),configuration:u.any().optional(),exited_at:u.string().nullable(),boot_progress:u.string().nullable(),boot_error:u.string().nullable(),shutdown_progress:u.string().nullable(),image_version:u.string().nullable()}),sl=u.object({id:u.number(),username:u.string()}),uo=u.object({id:u.number(),name:u.string(),region_identifier:u.string().nullable().optional()}),js=u.object({vcpu:u.number(),memory:u.number(),disk_size:u.number(),gpu_count:u.number().default(0)}),Ns=u.object({app:u.string(),instance:u.string()}),il=u.object({hosted:nl,name:u.string(),managed_user:sl.nullable(),node:uo.nullable(),listed:u.boolean().default(!1),status:u.string(),in_progress:u.boolean().default(!1),dapp_dashboard_url:u.string().nullable(),syslog_endpoint:u.string().nullable(),allow_upgrade:u.boolean().default(!1),project_id:u.string().nullable(),project_type:u.string().nullable(),billing_period:u.string().nullable(),kms_info:_e.nullable(),vcpu:u.number().nullable(),memory:u.number().nullable(),disk_size:u.number().nullable(),gateway_domain:u.string().nullable(),public_urls:u.array(Ns),machine_info:js.nullable().optional(),updated_at:u.string().nullable().optional()}),qs=u.object({id:u.number(),name:u.string(),status:u.string(),in_progress:u.boolean().optional().default(!1),teepod_id:u.number().nullable(),teepod:uo.optional().nullable(),app_id:u.string(),vm_uuid:u.string().nullable(),instance_id:u.string().nullable(),vcpu:u.number(),memory:u.number(),disk_size:u.number(),base_image:u.string().nullable(),encrypted_env_pubkey:u.string().nullable(),listed:u.boolean().optional().default(!1),project_id:u.string().optional().nullable(),project_type:u.string().optional().nullable(),instance_type:u.string().optional().nullable(),public_sysinfo:u.boolean().optional().default(!1),public_logs:u.boolean().optional().default(!1),dapp_dashboard_url:u.string().optional().nullable(),syslog_endpoint:u.string().optional().nullable(),kms_info:_e.optional().nullable(),contract_address:u.string().optional().nullable(),deployer_address:u.string().optional().nullable(),scheduled_delete_at:u.string().optional().nullable(),public_urls:u.array(Ns).optional().default([]),gateway_domain:u.string().optional().nullable(),machine_info:js.optional().nullable(),updated_at:u.string().optional().nullable()}),vr=u.object({id:u.number(),name:u.string(),status:u.string(),teepod_id:u.number(),teepod:uo.optional().nullable(),user_id:u.number().optional().nullable(),app_id:u.string(),vm_uuid:u.string().nullable(),instance_id:u.string().nullable(),app_url:u.string().optional().nullable().default(null),base_image:u.string().nullable(),vcpu:u.number(),memory:u.number(),disk_size:u.number(),manifest_version:u.number().optional().nullable().default(2),version:u.string().optional().nullable().default("1.0.0"),runner:u.string().optional().nullable().default("docker-compose"),docker_compose_file:u.string().optional().nullable(),features:u.array(u.string()).optional().nullable().default(["kms","tproxy-net"]),created_at:u.string(),encrypted_env_pubkey:u.string().nullable()});function Ms(e){return typeof e!="string"||e.length<5||e.length>63?!1:/^[a-zA-Z](?!.*--)([a-zA-Z0-9-]*[a-zA-Z0-9])?$/.test(e)}var He=pt.object({id:pt.string().optional(),uuid:pt.string().regex(/^[0-9a-f]{8}[-]?[0-9a-f]{4}[-]?4[0-9a-f]{3}[-]?[89ab][0-9a-f]{3}[-]?[0-9a-f]{12}$/i,"Invalid UUID format").optional(),app_id:pt.string().optional(),instance_id:pt.string().optional(),name:pt.string().refine(Ms,{message:"Name must be 5-63 characters, start with letter, and contain only letters/numbers/hyphens"}).optional()}),Oe=e=>e.refine(t=>{let r=t;return!!(r.id||r.uuid||r.app_id||r.instance_id||r.name)},{message:"One of id, uuid, app_id, instance_id, or name must be provided"}),al=Oe(He),R=al.transform(e=>{let t;if(e.id)t=e.id;else if(e.uuid)t=e.uuid;else if(e.app_id)t=e.app_id;else if(e.instance_id)t=e.instance_id;else{if(e.name)return{cvmId:e.name};throw new Error("No valid identifier provided")}let r=/^[0-9a-f]{8}[-]?[0-9a-f]{4}[-]?4[0-9a-f]{3}[-]?[89ab][0-9a-f]{3}[-]?[0-9a-f]{12}$/i,o=/^[0-9a-f]{40}$/i,n;return r.test(t)?n=t.replace(/-/g,""):o.test(t)?n=`app_${t}`:n=t,{cvmId:n}}),cl=R,{action:ll,safeAction:dt}=k(qs,async(e,t)=>{let{cvmId:r}=cl.parse(t);return await e.get(`/cvms/${r}`)}),pl=ce.object({page:ce.number().int().min(1).optional(),page_size:ce.number().int().min(1).optional(),node_id:ce.number().int().min(1).optional(),teepod_id:ce.number().int().min(1).optional(),user_id:ce.string().optional()}).strict(),ul=ce.object({items:ce.array(il),total:ce.number(),page:ce.number(),page_size:ce.number(),pages:ce.number()}).strict(),{action:fl,safeAction:fo}=k(ul,async(e,t)=>{let r=pl.parse(t??{});return await e.get("/cvms/paginated",{params:r})}),ml=v.object({app_id:v.string().nullable().optional(),app_env_encrypt_pubkey:v.string().nullable().optional(),compose_hash:v.string(),kms_info:_e.nullable().optional(),fmspc:v.string().nullable().optional(),device_id:v.string().nullable().optional(),os_image_hash:v.string().nullable().optional(),instance_type:v.string().nullable().optional(),teepod_id:v.number().nullable().optional(),node_id:v.number().nullable().optional(),kms_id:v.string().nullable().optional()}).passthrough().transform(e=>{if("teepod_id"in e&&e.teepod_id!==void 0){let{teepod_id:t,...r}=e;return{...r,node_id:t}}return e}),lo="Name must be 5-63 characters, start with letter, and contain only letters/numbers/hyphens",dl=v.object({node_id:v.number().optional(),teepod_id:v.number().optional(),region:v.string().optional(),name:v.string().min(5,lo).max(63,lo).refine(e=>Ms(e),lo),instance_type:v.string().optional(),image:v.string().optional(),vcpu:v.number().optional(),memory:v.number().optional(),disk_size:v.number().optional(),compose_file:v.object({allowed_envs:v.array(v.string()).optional(),pre_launch_script:v.string().optional(),docker_compose_file:v.string().optional(),name:v.string().optional().default(""),kms_enabled:v.boolean().optional(),public_logs:v.boolean().optional(),public_sysinfo:v.boolean().optional(),gateway_enabled:v.boolean().optional(),tproxy_enabled:v.boolean().optional()}),listed:v.boolean().optional(),kms_id:v.string().optional(),kms:v.enum(["PHALA","ETHEREUM","BASE"]).optional(),kms_contract:v.string().optional(),env_keys:v.array(v.string()).optional(),nonce:v.number().optional(),app_id:v.string().optional()}).passthrough().transform(e=>!e.instance_type&&!e.vcpu&&!e.memory?{...e,instance_type:"tdx.small"}:e);function hl(e){if(!e.compose_file)return e;let t={...e.compose_file};return typeof t.gateway_enabled=="boolean"&&typeof t.tproxy_enabled=="boolean"?delete t.tproxy_enabled:typeof t.tproxy_enabled=="boolean"&&typeof t.gateway_enabled>"u"&&(t.gateway_enabled=t.tproxy_enabled,delete t.tproxy_enabled,(typeof window<"u"?window.console:globalThis.console)&&console.warn("[phala/cloud] tproxy_enabled is deprecated, please use gateway_enabled instead. See docs for migration.")),{...e,compose_file:t}}var{action:xl,safeAction:gl}=k(ml,async(e,t)=>{let r=dl.parse(t),o=hl(r),n={...o};return typeof o.node_id=="number"?(n={...o,teepod_id:o.node_id},delete n.node_id):typeof o.teepod_id=="number"&&console.warn("[phala/cloud] teepod_id is deprecated, please use node_id instead."),await e.post("/cvms/provision",n)}),bl=C.object({id:C.number(),name:C.string(),status:C.string(),teepod_id:C.number(),teepod:C.object({id:C.number(),name:C.string()}).nullable(),user_id:C.number().nullable(),app_id:C.string().nullable(),vm_uuid:C.string().nullable(),instance_id:C.string().nullable(),app_url:C.string().nullable().default(null),base_image:C.string().nullable(),vcpu:C.number(),memory:C.number(),disk_size:C.number(),manifest_version:C.number().nullable().default(2),version:C.string().nullable().default("1.0.0"),runner:C.string().nullable().default("docker-compose"),docker_compose_file:C.string().nullable(),features:C.array(C.string()).nullable().default(["kms","tproxy-net"]),created_at:C.string(),encrypted_env_pubkey:C.string().nullable().optional(),app_auth_contract_address:C.string().nullable().optional(),deployer_address:C.string().nullable().optional()}).passthrough(),Ox=C.object({encrypted_env:C.string().optional().nullable(),app_id:C.string(),compose_hash:C.string(),kms_id:C.string().optional(),contract_address:C.string().optional(),deployer_address:C.string().optional(),env_keys:C.array(C.string()).optional().nullable()}).passthrough(),{action:yl,safeAction:vl}=k(bl,async(e,t)=>await e.post("/cvms",t)),Gs=G.object({allowed_envs:G.array(G.string()).optional(),docker_compose_file:G.string(),features:G.array(G.string()).optional(),name:G.string().optional(),manifest_version:G.number().optional(),kms_enabled:G.boolean().optional(),public_logs:G.boolean().optional(),public_sysinfo:G.boolean().optional(),tproxy_enabled:G.boolean().optional(),pre_launch_script:G.string().optional(),env_pubkey:G.string().optional(),salt:G.string().optional().nullable()}).passthrough();function po(e){return e==null?e:Array.isArray(e)?e.map(po):e&&typeof e=="object"&&e.constructor===Object?Object.keys(e).sort().reduce((t,r)=>{let o=e[r];return t[r]=po(o),t},{}):e}function Ds(e){let t={...e};return t.runner==="bash"&&"docker_compose_file"in t?delete t.docker_compose_file:t.runner==="docker-compose"&&"bash_script"in t&&delete t.bash_script,"pre_launch_script"in t&&!t.pre_launch_script&&delete t.pre_launch_script,t}function Vs(e){let t=po(e),r=JSON.stringify(t,null,4);return r=r.replace(/": /g,'":'),r}function _l(e){let t=Ds(e),r=Vs(t);return wl.createHash("sha256").update(r,"utf8").digest("hex")}function Cl(e){let t=e;return{...e,getHash:()=>_l(t),toString:()=>Vs(Ds(t))}}var kl=Gs.transform(e=>Cl(e)),Tl=R,{action:El,safeAction:mo}=k(kl,async(e,t)=>{let{cvmId:r}=Tl.parse(t);return await e.get(`/cvms/${r}/compose_file`)}),Sl=ye.object({id:ye.string().optional(),uuid:ye.string().regex(/^[0-9a-f]{8}[-]?[0-9a-f]{4}[-]?4[0-9a-f]{3}[-]?[89ab][0-9a-f]{3}[-]?[0-9a-f]{12}$/i).optional(),app_id:ye.string().refine(e=>!e.startsWith("app_")&&e.length===40,"app_id should be 40 characters without prefix").transform(e=>e.startsWith("app_")?e:`app_${e}`).optional(),instance_id:ye.string().refine(e=>!e.startsWith("instance_")&&e.length===40,"instance_id should be 40 characters without prefix").transform(e=>e.startsWith("instance_")?e:`instance_${e}`).optional(),app_compose:Gs,update_env_vars:ye.boolean().optional().nullable()}).refine(e=>!!(e.id||e.uuid||e.app_id||e.instance_id),"One of id, uuid, app_id, or instance_id must be provided").transform(e=>({cvmId:e.id||e.uuid||e.app_id||e.instance_id,request:{...e.app_compose,update_env_vars:e.update_env_vars},_raw:e})),Il=ye.object({app_id:ye.string().nullable(),device_id:ye.string().nullable(),compose_hash:ye.string(),kms_info:_e.nullable().optional()}).passthrough(),{action:Al,safeAction:Pl}=k(Il,async(e,t)=>{let r=Sl.parse(t);return await e.post(`/cvms/${r.cvmId}/compose_file/provision`,r.request)}),Bl=me.object({id:me.string().optional(),uuid:me.string().regex(/^[0-9a-f]{8}[-]?[0-9a-f]{4}[-]?4[0-9a-f]{3}[-]?[89ab][0-9a-f]{3}[-]?[0-9a-f]{12}$/i).optional(),app_id:me.string().refine(e=>!e.startsWith("app_")&&e.length===40,"app_id should be 40 characters without prefix").transform(e=>e.startsWith("app_")?e:`app_${e}`).optional(),instance_id:me.string().refine(e=>!e.startsWith("instance_")&&e.length===40,"instance_id should be 40 characters without prefix").transform(e=>e.startsWith("instance_")?e:`instance_${e}`).optional(),compose_hash:me.string().min(1,"Compose hash is required"),encrypted_env:me.string().optional(),env_keys:me.array(me.string()).optional(),update_env_vars:me.boolean().optional().nullable()}).refine(e=>!!(e.id||e.uuid||e.app_id||e.instance_id),"One of id, uuid, app_id, or instance_id must be provided").transform(e=>({cvmId:e.id||e.uuid||e.app_id||e.instance_id,compose_hash:e.compose_hash,encrypted_env:e.encrypted_env,env_keys:e.env_keys,update_env_vars:e.update_env_vars??void 0,_raw:e})),$l=me.any().transform(()=>{}),{action:Ll,safeAction:Rl}=k($l,async(e,t)=>{let r=Bl.parse(t);return await e.patch(`/cvms/${r.cvmId}/compose_file`,{compose_hash:r.compose_hash,encrypted_env:r.encrypted_env,env_keys:r.env_keys,update_env_vars:r.update_env_vars})}),Ul=Oe(He.extend({encrypted_env:j.string().describe("Encrypted environment variables (hex string)"),env_keys:j.array(j.string()).optional().describe("List of allowed environment variable keys"),compose_hash:j.string().optional().describe("Compose hash for verification (Phase 2, required when env_keys changes)"),transaction_hash:j.string().optional().describe("On-chain transaction hash for verification (Phase 2, required when env_keys changes)")})).transform(e=>{let{cvmId:t}=R.parse(e);return{cvmId:t,request:{encrypted_env:e.encrypted_env,env_keys:e.env_keys,compose_hash:e.compose_hash,transaction_hash:e.transaction_hash},_raw:e}}),zl=j.object({status:j.literal("in_progress"),message:j.string(),correlation_id:j.string(),allowed_envs_changed:j.boolean()}),Fl=j.object({status:j.literal("precondition_required"),message:j.string(),compose_hash:j.string(),app_id:j.string(),device_id:j.string(),kms_info:_e}),Hl=j.union([zl,Fl]),{action:Ol,safeAction:jl}=k(Hl,async(e,t)=>{let r=Ul.parse(t);try{return await e.patch(`/cvms/${r.cvmId}/envs`,r.request)}catch(o){if(o instanceof we&&o.status===465){let n=o.detail;if(n&&typeof n=="object"){let s=n;return{status:"precondition_required",message:s.message||"Compose hash verification required",compose_hash:s.compose_hash,app_id:s.app_id,device_id:s.device_id,kms_info:s.kms_info}}}throw o}}),Nl=Oe(He.extend({docker_compose_file:Y.string().describe("Docker Compose YAML content"),compose_hash:Y.string().optional().describe("Compose hash for verification (Phase 2, contract-owned KMS only)"),transaction_hash:Y.string().optional().describe("On-chain transaction hash for verification (Phase 2, contract-owned KMS only)")})).transform(e=>{let{cvmId:t}=R.parse(e);return{cvmId:t,request:{docker_compose_file:e.docker_compose_file,compose_hash:e.compose_hash,transaction_hash:e.transaction_hash},_raw:e}}),ql=Y.object({status:Y.literal("in_progress"),message:Y.string(),correlation_id:Y.string()}),Ml=Y.object({status:Y.literal("precondition_required"),message:Y.string(),compose_hash:Y.string(),app_id:Y.string(),device_id:Y.string(),kms_info:_e}),Gl=Y.union([ql,Ml]),{action:Dl,safeAction:Vl}=k(Gl,async(e,t)=>{let r=Nl.parse(t),o={"Content-Type":"text/yaml"};r.request.compose_hash&&(o["X-Compose-Hash"]=r.request.compose_hash),r.request.transaction_hash&&(o["X-Transaction-Hash"]=r.request.transaction_hash);try{return await e.patch(`/cvms/${r.cvmId}/docker-compose`,r.request.docker_compose_file,{headers:o})}catch(n){if(n instanceof we&&n.status===465){let s=n.detail;if(s&&typeof s=="object"){let i=s;return{status:"precondition_required",message:i.message||"Compose hash verification required",compose_hash:i.compose_hash,app_id:i.app_id,device_id:i.device_id,kms_info:i.kms_info}}}throw n}}),Kl=Oe(He.extend({pre_launch_script:Q.string().describe("Pre-launch script content (shell script)"),compose_hash:Q.string().optional().describe("Compose hash for verification (Phase 2, contract-owned KMS only)"),transaction_hash:Q.string().optional().describe("On-chain transaction hash for verification (Phase 2, contract-owned KMS only)")})).transform(e=>{let{cvmId:t}=R.parse(e);return{cvmId:t,request:{pre_launch_script:e.pre_launch_script,compose_hash:e.compose_hash,transaction_hash:e.transaction_hash},_raw:e}}),Wl=Q.object({status:Q.literal("in_progress"),message:Q.string(),correlation_id:Q.string()}),Xl=Q.object({status:Q.literal("precondition_required"),message:Q.string(),compose_hash:Q.string(),app_id:Q.string(),device_id:Q.string(),kms_info:_e}),Jl=Q.union([Wl,Xl]),{action:Zl,safeAction:Yl}=k(Jl,async(e,t)=>{let r=Kl.parse(t),o={"Content-Type":"text/plain"};r.request.compose_hash&&(o["X-Compose-Hash"]=r.request.compose_hash),r.request.transaction_hash&&(o["X-Transaction-Hash"]=r.request.transaction_hash);try{return await e.patch(`/cvms/${r.cvmId}/pre-launch-script`,r.request.pre_launch_script,{headers:o})}catch(n){if(n instanceof we&&n.status===465){let s=n.detail;if(s&&typeof s=="object"){let i=s;return{status:"precondition_required",message:i.message||"Compose hash verification required",compose_hash:i.compose_hash,app_id:i.app_id,device_id:i.device_id,kms_info:i.kms_info}}}throw n}}),ep=R,{action:tp,safeAction:rp}=k(Ql.string(),async(e,t)=>{let{cvmId:r}=ep.parse(t);return await e.get(`/cvms/${r}/pre-launch-script`)}),op=As.object({kms_id:As.string().min(1,"KMS ID is required")}),{action:np,safeAction:sp}=k(_e,async(e,t)=>{let r=op.parse(t);return await e.get(`/kms/${r.kms_id}`)}),ip=ve.object({page:ve.number().int().min(1).optional(),page_size:ve.number().int().min(1).optional(),is_onchain:ve.boolean().optional()}).strict(),ap=ve.object({items:ve.array(_e),total:ve.number(),page:ve.number(),page_size:ve.number(),pages:ve.number()}).strict(),{action:cp,safeAction:lp}=k(ap,async(e,t)=>{let r=ip.parse(t??{});return await e.get("/kms",{params:r})}),pp=mt.object({kms:mt.string().min(1,"KMS ID or slug is required"),app_id:mt.string().refine(e=>e.length===40||e.startsWith("0x")&&e.length===42,"App ID must be exactly 40 characters or 42 characters with 0x prefix")}).strict(),up=mt.object({public_key:mt.string(),signature:mt.string()}).strict(),{action:fp,safeAction:mp}=k(up,async(e,t)=>{let r=pp.parse(t);return await e.get(`/kms/${r.kms}/pubkey/${r.app_id}`)}),dp=Je.object({counts:Je.number().int().min(1).max(20).optional().default(1)}).strict(),hp=Je.object({app_ids:Je.array(Je.object({app_id:Je.string(),nonce:Je.number().int().min(0)}))}).strict(),{action:xp,safeAction:gp}=k(hp,async(e,t)=>{let r=dp.parse(t??{}),o=new URLSearchParams;return o.append("counts",r.counts.toString()),await e.get(`/kms/phala/next_app_id?${o.toString()}`)}),bp=R,{action:yp,safeAction:vp}=k(vr,async(e,t)=>{let{cvmId:r}=bp.parse(t);return await e.post(`/cvms/${r}/start`)}),wp=R,{action:_p,safeAction:Cp}=k(vr,async(e,t)=>{let{cvmId:r}=wp.parse(t);return await e.post(`/cvms/${r}/stop`)}),kp=R,{action:Tp,safeAction:Ep}=k(vr,async(e,t)=>{let{cvmId:r}=kp.parse(t);return await e.post(`/cvms/${r}/shutdown`)}),Ip=Oe(He.extend({force:Sp.boolean().optional()})),{action:Ap,safeAction:Pp}=k(vr,async(e,t)=>{let r=Ip.parse(t),{cvmId:o}=R.parse(r),{force:n=!1}=r;return await e.post(`/cvms/${o}/restart`,{force:n})}),$p=R,{action:Lp,safeAction:Rp}=k(Bp.void(),async(e,t)=>{let{cvmId:r}=$p.parse(t);await e.delete(`/cvms/${r}`)}),Up=S.object({name:S.string(),mount_point:S.string(),total_size:S.number(),free_size:S.number()}),zp=S.object({os_name:S.string(),os_version:S.string(),kernel_version:S.string(),cpu_model:S.string(),num_cpus:S.number(),total_memory:S.number(),available_memory:S.number(),used_memory:S.number(),free_memory:S.number(),total_swap:S.number(),used_swap:S.number(),free_swap:S.number(),uptime:S.number(),loadavg_one:S.number(),loadavg_five:S.number(),loadavg_fifteen:S.number(),disks:S.array(Up)}),Fp=S.object({is_online:S.boolean(),is_public:S.boolean().default(!1),error:S.string().nullable(),sysinfo:zp.nullable(),status:S.string().nullable(),in_progress:S.boolean().default(!1),boot_progress:S.string().nullable(),boot_error:S.string().nullable()}),Hp=R,{action:Op,safeAction:jp}=k(Fp,async(e,t)=>{let{cvmId:r}=Hp.parse(t);return await e.get(`/cvms/${r}/stats`)}),Np=be.object({app:be.string(),instance:be.string()}),qp=be.object({is_online:be.boolean(),is_public:be.boolean().default(!0),error:be.string().nullable(),internal_ip:be.string().nullable(),latest_handshake:be.string().nullable(),public_urls:be.array(Np).nullable()}),Mp=R,{action:Gp,safeAction:Dp}=k(qp,async(e,t)=>{let{cvmId:r}=Mp.parse(t);return await e.get(`/cvms/${r}/network`)}),Kp=R,{action:Wp,safeAction:Xp}=k(Vp.string(),async(e,t)=>{let{cvmId:r}=Kp.parse(t);return await e.get(`/cvms/${r}/docker-compose.yml`)}),Jp=$.object({id:$.string(),names:$.array($.string()),image:$.string(),image_id:$.string(),command:$.string().nullable().optional(),created:$.number(),state:$.string(),status:$.string(),log_endpoint:$.string().nullable()}),Zp=$.object({is_online:$.boolean(),is_public:$.boolean().default(!0),error:$.string().nullable(),docker_compose_file:$.string().nullable(),manifest_version:$.number().nullable(),version:$.string().nullable(),runner:$.string().nullable(),features:$.array($.string()).nullable(),containers:$.array(Jp).nullable()}),Yp=R,{action:Qp,safeAction:eu}=k(Zp,async(e,t)=>{let{cvmId:r}=Yp.parse(t);return await e.get(`/cvms/${r}/composition`)}),tu=g.object({common_name:g.string().nullable(),organization:g.string().nullable(),country:g.string().nullable(),state:g.string().nullable(),locality:g.string().nullable()}),ru=g.object({common_name:g.string().nullable(),organization:g.string().nullable(),country:g.string().nullable()}),ou=g.object({subject:tu,issuer:ru,serial_number:g.string(),not_before:g.string(),not_after:g.string(),version:g.string(),fingerprint:g.string(),signature_algorithm:g.string(),sans:g.array(g.string()).nullable(),is_ca:g.boolean(),position_in_chain:g.number().nullable(),quote:g.string().nullable(),app_id:g.string().nullable().optional(),cert_usage:g.string().nullable().optional()}),nu=g.object({imr:g.number(),event_type:g.number(),digest:g.string(),event:g.string(),event_payload:g.string()}),su=g.object({mrtd:g.string(),rootfs_hash:g.string().nullable().optional(),rtmr0:g.string(),rtmr1:g.string(),rtmr2:g.string(),rtmr3:g.string(),event_log:g.array(nu),app_compose:g.string()}),iu=g.object({name:g.string().nullable(),is_online:g.boolean(),is_public:g.boolean().default(!0),error:g.string().nullable(),app_certificates:g.array(ou).nullable(),tcb_info:su.nullable(),compose_file:g.string().nullable()}),au=R,{action:cu,safeAction:lu}=k(iu,async(e,t)=>{let{cvmId:r}=au.parse(t);return await e.get(`/cvms/${r}/attestation`)}),pu=Oe(He.extend({vcpu:ft.number().optional(),memory:ft.number().optional(),disk_size:ft.number().optional(),instance_type:ft.string().optional(),allow_restart:ft.boolean().optional()})),{action:uu,safeAction:fu}=k(ft.void(),async(e,t)=>{let r=pu.parse(t),{cvmId:o}=R.parse(r),{...n}=r;await e.patch(`/cvms/${o}/resources`,n)}),mu=Oe(He.extend({public_sysinfo:Ps.boolean(),public_logs:Ps.boolean()})),{action:du,safeAction:hu}=k(qs,async(e,t)=>{let r=mu.parse(t),{cvmId:o}=R.parse(r),{public_sysinfo:n,public_logs:s}=r;return await e.patch(`/cvms/${o}/visibility`,{public_sysinfo:n,public_logs:s})}),Bs=M.object({name:M.string(),os_image_hash:M.string().nullable(),is_current:M.boolean()}),xu=M.object({version:M.union([M.tuple([M.number(),M.number(),M.number(),M.number()]),M.tuple([M.number(),M.number(),M.number()])]),prod:Bs.nullable(),dev:Bs.nullable()}),gu=M.array(xu),bu=R,{action:yu,safeAction:vu}=k(gu,async(e,t)=>{let{cvmId:r}=bu.parse(t);return await e.get(`/cvms/${r}/available-os-images`)}),wu=Oe(He.extend({os_image_name:Ks.string().min(1,"OS image name is required")})),{action:_u,safeAction:Cu}=k(Ks.void(),async(e,t)=>{let r=wu.parse(t),{cvmId:o}=R.parse(r),{os_image_name:n}=r;await e.patch(`/cvms/${o}/os-image`,{os_image_name:n})}),ku=ge.object({id:ge.string().optional(),instance_id:ge.string().optional(),name:ge.string(),status:ge.string(),uptime:ge.string().optional(),exited_at:ge.string().optional(),boot_progress:ge.string().optional(),boot_error:ge.string().optional(),shutdown_progress:ge.string().optional()}),Tu=R,{action:Eu,safeAction:Su}=k(ku,async(e,t)=>{let{cvmId:r}=Tu.parse(t);return await e.get(`/cvms/${r}/state`)});function Ws(e={}){let t=$c(e),r={getCurrentUser:Rc,safeGetCurrentUser:Uc,getAvailableNodes:qc,safeGetAvailableNodes:Mc,listAllInstanceTypeFamilies:Wc,safeListAllInstanceTypeFamilies:Xc,listFamilyInstanceTypes:Jc,safeListFamilyInstanceTypes:Zc,listWorkspaces:el,safeListWorkspaces:tl,getWorkspace:rl,safeGetWorkspace:ol,getCvmInfo:ll,safeGetCvmInfo:dt,getCvmList:fl,safeGetCvmList:fo,provisionCvm:xl,safeProvisionCvm:gl,commitCvmProvision:yl,safeCommitCvmProvision:vl,getCvmComposeFile:El,safeGetCvmComposeFile:mo,provisionCvmComposeFileUpdate:Al,safeProvisionCvmComposeFileUpdate:Pl,commitCvmComposeFileUpdate:Ll,safeCommitCvmComposeFileUpdate:Rl,updateCvmEnvs:Ol,safeUpdateCvmEnvs:jl,updateDockerCompose:Dl,safeUpdateDockerCompose:Vl,updatePreLaunchScript:Zl,safeUpdatePreLaunchScript:Yl,getCvmPreLaunchScript:tp,safeGetCvmPreLaunchScript:rp,startCvm:yp,safeStartCvm:vp,stopCvm:_p,safeStopCvm:Cp,shutdownCvm:Tp,safeShutdownCvm:Ep,restartCvm:Ap,safeRestartCvm:Pp,deleteCvm:Lp,safeDeleteCvm:Rp,getCvmStats:Op,safeGetCvmStats:jp,getCvmNetwork:Gp,safeGetCvmNetwork:Dp,getCvmDockerCompose:Wp,safeGetCvmDockerCompose:Xp,getCvmContainersStats:Qp,safeGetCvmContainersStats:eu,getCvmAttestation:cu,safeGetCvmAttestation:lu,updateCvmResources:uu,safeUpdateCvmResources:fu,updateCvmVisibility:du,safeUpdateCvmVisibility:hu,getAvailableOsImages:yu,safeGetAvailableOsImages:vu,updateOsImage:_u,safeUpdateOsImage:Cu,getKmsInfo:np,safeGetKmsInfo:sp,getKmsList:cp,safeGetKmsList:lp,getAppEnvEncryptPubKey:fp,safeGetAppEnvEncryptPubKey:mp,nextAppIds:xp,safeNextAppIds:gp,getCvmState:Eu,safeGetCvmState:Su};return t.extend(r)}var Iu=U.object({chain:U.unknown().optional(),rpcUrl:U.string().optional(),kmsContractAddress:U.string(),privateKey:U.string().optional(),walletClient:U.unknown().optional(),publicClient:U.unknown().optional(),allowAnyDevice:U.boolean().optional().default(!1),deviceId:U.string().optional().default("0000000000000000000000000000000000000000000000000000000000000000"),composeHash:U.string().optional().default("0000000000000000000000000000000000000000000000000000000000000000"),disableUpgrades:U.boolean().optional().default(!1),skipPrerequisiteChecks:U.boolean().optional().default(!1),minBalance:U.string().optional()}).passthrough(),mg=Iu.refine(e=>{let t=!!e.privateKey,r=!!e.walletClient;return t!==r},{message:"Either 'privateKey' or 'walletClient' must be provided, but not both",path:["privateKey","walletClient"]}).refine(e=>{let t=!!e.publicClient,r=!!e.walletClient,o=!!e.chain;return t&&r?!0:o},{message:"Chain is required when publicClient or walletClient is not provided",path:["chain"]}),dg=U.object({appId:U.string(),appAuthAddress:U.string(),deployer:U.string(),transactionHash:U.string(),blockNumber:U.bigint().optional(),gasUsed:U.bigint().optional()}).passthrough();var xg=B.object({chain:B.unknown().optional(),rpcUrl:B.string().optional(),appId:B.string(),composeHash:B.string(),privateKey:B.string().optional(),walletClient:B.unknown().optional(),publicClient:B.unknown().optional(),skipPrerequisiteChecks:B.boolean().optional().default(!1),minBalance:B.string().optional(),timeout:B.number().optional().default(12e4),retryOptions:B.unknown().optional(),signal:B.unknown().optional(),onTransactionStateChange:B.function().optional(),onTransactionSubmitted:B.function().optional(),onTransactionConfirmed:B.function().optional()}).passthrough().refine(e=>{let t=!!e.privateKey,r=!!e.walletClient;return t!==r},{message:"Either 'privateKey' or 'walletClient' must be provided, but not both",path:["privateKey","walletClient"]}).refine(e=>{let t=!!e.publicClient,r=!!e.walletClient,o=!!e.chain;return t&&r?!0:o},{message:"Chain is required when publicClient or walletClient is not provided",path:["chain"]}),gg=B.object({composeHash:B.string(),appId:B.string(),transactionHash:B.string(),blockNumber:B.bigint().optional(),gasUsed:B.bigint().optional()}).passthrough();var yg=ut.object({target:ut.string().describe("Target status to wait for (e.g., 'running', 'stopped')"),interval:ut.number().min(5).max(30).default(5).describe("Polling interval in seconds"),timeout:ut.number().min(10).max(600).default(300).describe("Timeout per attempt in seconds"),maxRetries:ut.number().min(0).default(Number.POSITIVE_INFINITY).describe("Maximum number of retry attempts (Infinity for unlimited)"),retryDelay:ut.number().min(0).default(5e3).describe("Delay between retries in milliseconds")});var Au=D.object({vm_uuid:D.string(),status:D.string(),uptime:D.string().nullable().optional(),in_progress:D.boolean(),boot_progress:D.string().nullable().optional(),boot_error:D.string().nullable().optional(),operation_type:D.string().nullable().optional(),operation_started_at:D.string().nullable().optional(),correlation_id:D.string().nullable().optional()}),Pu=D.record(D.string(),Au),Bu=D.object({vmUuids:D.array(D.string())}),{action:wg,safeAction:_g}=k(Pu,async(e,t)=>{let{vmUuids:r}=Bu.parse(t);return await e.post("/status/batch",{vm_uuids:r})});import Ys from"crypto";import Js from"fs";import ht from"os";import ho from"path";import V from"chalk";import zu from"ora";var Uu=!1;function de(){return Uu}function Fu(e,t){let r=e.split(/\s+/),o=[],n="";for(let s of r){let i=n.length===0?s:`${n} ${s}`;i.length<=t?n=i:(n.length>0&&o.push(n),n=s)}return n.length>0&&o.push(n),o}function Hu(e,t){if(e.length<=t)return[e];let r=[],o=0;for(;o<e.length;)r.push(e.slice(o,o+t)),o+=t;return r}function Xs(e,t){let r=[];for(let o of e.split(`
`)){if(o.length<=t){r.push(o);continue}if(o.indexOf(" ")===-1){r.push(...Hu(o,t));continue}let n=Fu(o,t);r.push(...n)}if(r.length===0){let o=e.trim();r.push(o)}return r}var je={error:(e,...t)=>{de()||(process.stderr.write(`${V.red("\u2717")} ${V.red(e)}`),t.length>0&&process.stderr.write(` ${t.map(String).join(" ")}`),process.stderr.write(`
`))},warn:(e,...t)=>{de()||(process.stderr.write(`${V.yellow("\u26A0")} ${V.yellow(e)}`),t.length>0&&process.stderr.write(` ${t.map(String).join(" ")}`),process.stderr.write(`
`))},info:(e,...t)=>{de()||(process.stderr.write(`${V.blue("\u2139")} ${V.blue(e)}`),t.length>0&&process.stderr.write(` ${t.map(String).join(" ")}`),process.stderr.write(`
`))},success:(e,...t)=>{de()||(process.stderr.write(`${V.green("\u2713")} ${V.green(e)}`),t.length>0&&process.stderr.write(` ${t.map(String).join(" ")}`),process.stderr.write(`
`))},debug:(e,...t)=>{de()||process.env.DEBUG&&(process.stderr.write(`${V.gray("\u{1F50D}")} ${V.gray(e)}`),t.length>0&&process.stderr.write(` ${t.map(String).join(" ")}`),process.stderr.write(`
`))},table:(e,t)=>{if(!de()){if(e.length===0){console.log(V.yellow("No data to display"));return}if(t){let r;typeof t[0]=="string"?r=t.map(i=>({key:i,header:i})):r=t;let o={};for(let i of r){let a=i.header||String(i.key);o[String(i.key)]=a.length}for(let i of e)for(let a of r){let l=String(typeof a.key=="string"&&!(a.key in i)?"":i[String(a.key)]??"");o[String(a.key)]=Math.max(o[String(a.key)],l.length)}let n=[];for(let i of r){let a=i.header||String(i.key);n.push(V.bold(a.padEnd(o[String(i.key)])))}console.log(n.join("  "));let s=[];for(let i of r)s.push("-".repeat(o[String(i.key)]));console.log(s.join("  "));for(let i of e){let a=[];for(let l of r){let f=String(typeof l.key=="string"&&!(l.key in i)?"":i[String(l.key)]??"");a.push(f.padEnd(o[String(l.key)]))}console.log(a.join("  "))}}else{let r=e[0],o=Object.keys(r),n={};for(let a of o)n[a]=a.length;for(let a of e)for(let l of o){let f=String(a[l]??"");n[l]=Math.max(n[l],f.length)}let s=[];for(let a of o)s.push(V.bold(a.padEnd(n[a])));console.log(s.join("  "));let i=[];for(let a of o)i.push("-".repeat(n[a]));console.log(i.join("  "));for(let a of e){let l=[];for(let f of o){let m=String(a[f]??"");l.push(m.padEnd(n[f]))}console.log(l.join("  "))}}}},keyValueTable:(e,t)=>{if(de())return;let{borderStyle:r="single",keyColor:o=V.blue,valueColor:n=V.white,maxWidth:s=process.stdout.columns||80}=t||{},a={single:{topLeft:"\u250C",topRight:"\u2510",bottomLeft:"\u2514",bottomRight:"\u2518",horizontal:"\u2500",vertical:"\u2502",cross:"\u253C",leftT:"\u251C",rightT:"\u2524"},double:{topLeft:"\u2554",topRight:"\u2557",bottomLeft:"\u255A",bottomRight:"\u255D",horizontal:"\u2550",vertical:"\u2551",cross:"\u256C",leftT:"\u2560",rightT:"\u2563"},rounded:{topLeft:"\u256D",topRight:"\u256E",bottomLeft:"\u2570",bottomRight:"\u256F",horizontal:"\u2500",vertical:"\u2502",cross:"\u253C",leftT:"\u251C",rightT:"\u2524"},bold:{topLeft:"\u250F",topRight:"\u2513",bottomLeft:"\u2517",bottomRight:"\u251B",horizontal:"\u2501",vertical:"\u2503",cross:"\u254B",leftT:"\u2523",rightT:"\u252B"},none:{topLeft:"",topRight:"",bottomLeft:"",bottomRight:"",horizontal:"",vertical:"",cross:"",leftT:"",rightT:""}}[r],l=0,f=0;for(let[I,T]of Object.entries(e)){l=Math.max(l,I.length);let P=String(T??"");f=Math.max(f,P.length)}let m=4,p=1,d=s-m-p;if(l+f>d){let I=l/(l+f);l=Math.floor(d*I),f=d-l}let h=l+f+m+p;r!=="none"&&console.log(a.topLeft+a.horizontal.repeat(h-2)+a.topRight);for(let[I,T]of Object.entries(e)){let P=I,K=String(T??""),W=Xs(P,l),O=Xs(K,f),ee=Math.max(W.length,O.length);for(;W.length<ee;)W.push("");for(;O.length<ee;)O.push("");for(let le=0;le<ee;le++){let re=W[le].padEnd(l),Ut=O[le].padEnd(f);console.log(r!=="none"?`${a.vertical} ${o(re)} ${a.vertical} ${n(Ut)} ${a.vertical}`:`${o(re)} : ${n(Ut)}`)}}r!=="none"&&console.log(a.bottomLeft+a.horizontal.repeat(h-2)+a.bottomRight)},break:()=>{de()||process.stderr.write(`
`)},startSpinner:e=>{if(de())return{stop:()=>{}};let t=zu(e).start();return{stop:(r=!0,o)=>{o&&(t.text=o),r?t.succeed():t.fail()}}},logDetailedError(e,t){if(de())return;let r=t?`[${t}] `:"",o=s=>s!==null&&typeof s=="object"&&"isRequestError"in s&&s.isRequestError===!0&&"status"in s&&"message"in s&&"data"in s,n=s=>s!==null&&typeof s=="object"&&"issues"in s&&Array.isArray(s.issues);if(o(e)){process.stderr.write(`${r}HTTP ${e.status}: ${e.message}
`),e.data!==void 0&&e.data!==null&&process.stderr.write(`${JSON.stringify(e.data,null,2)}
`);return}if(n(e)){process.stderr.write(`${r}Validation error: ${JSON.stringify(e.issues)}
`);return}e instanceof Error?process.stderr.write(`${r}${e.message}
`):process.stderr.write(`${r}${String(e)}
`)}};var Qs=ho.join(ht.homedir(),".phala-cloud"),Zs=ho.join(Qs,"api-key"),Gg=ho.join(Qs,"docker-credentials.json");function Ou(){let e=[ht.hostname(),ht.platform(),ht.arch(),ht.cpus()[0]?.model||"",ht.userInfo().username],t=Ys.createHash("sha256");return t.update(e.join("|")),t.digest()}function ju(e){try{let t=Ou(),r=e.split(":");if(r.length!==2)throw new Error("Invalid encrypted format");let o=Buffer.from(r[0],"hex"),n=r[1],s=Ys.createDecipheriv("aes-256-cbc",t.slice(0,32),o),i=s.update(n,"hex","utf8");return i+=s.final("utf8"),i}catch(t){throw je.error("Decryption failed:",t),new Error("Failed to decrypt data")}}function ei(){try{if(process.env.PHALA_CLOUD_API_KEY)return process.env.PHALA_CLOUD_API_KEY;if(Js.existsSync(Zs)){let e=Js.readFileSync(Zs,"utf8").trim();return ju(e)}return null}catch(e){return je.error("Failed to read API key:",e),null}}async function N(){let e=ei();return Ws({apiKey:e})}import{z as c}from"zod";var Nu=c.object({password:c.string(),registry:c.string().nullable(),username:c.string()}),Jg=c.object({docker_compose_file:c.string(),docker_config:Nu.optional().nullable(),features:c.array(c.string()),kms_enabled:c.boolean(),manifest_version:c.number(),name:c.string(),public_logs:c.boolean(),public_sysinfo:c.boolean(),runner:c.string().optional(),salt:c.string().nullable().optional(),tproxy_enabled:c.boolean(),version:c.string().optional()}).passthrough(),ti=c.object({id:c.number(),name:c.string(),status:c.string(),teepod_id:c.number().nullable(),teepod:c.object({id:c.number(),name:c.string()}).nullable(),user_id:c.number().nullable(),app_id:c.string(),vm_uuid:c.string().nullable(),instance_id:c.string().nullable(),app_url:c.string().nullable(),base_image:c.string().nullable(),vcpu:c.number(),memory:c.number(),disk_size:c.number(),manifest_version:c.number().nullable(),version:c.string().nullable(),runner:c.string().nullable(),docker_compose_file:c.string().nullable(),features:c.array(c.string()).nullable(),created_at:c.string(),encrypted_env_pubkey:c.string().nullable()}),Zg=c.object({key:c.string(),value:c.string()}),ri=c.object({is_online:c.boolean(),is_public:c.boolean(),error:c.string().nullable(),internal_ip:c.string(),latest_handshake:c.string(),public_urls:c.array(c.object({app:c.string(),instance:c.string()}))}),oi=c.object({id:c.number(),name:c.string(),status:c.string(),teepod_id:c.number(),teepod:c.object({id:c.number(),name:c.string()}),user_id:c.number().nullable(),app_id:c.string(),vm_uuid:c.string().nullable(),instance_id:c.string().nullable(),app_url:c.string().nullable(),base_image:c.string().nullable(),vcpu:c.number(),memory:c.number(),disk_size:c.number(),manifest_version:c.number().nullable(),version:c.string().nullable(),runner:c.string().nullable(),docker_compose_file:c.string().nullable(),features:c.array(c.string()).nullable(),created_at:c.string(),encrypted_env_pubkey:c.string().nullable()}),ni=c.object({is_online:c.boolean(),is_public:c.boolean(),error:c.string().nullable(),app_certificates:c.array(c.object({subject:c.object({common_name:c.string().nullable(),organization:c.string().nullable(),country:c.string().nullable(),state:c.string().nullable().optional(),locality:c.string().nullable().optional()}),issuer:c.object({common_name:c.string().nullable(),organization:c.string().nullable(),country:c.string().nullable()}),serial_number:c.string(),not_before:c.string(),not_after:c.string(),version:c.string(),fingerprint:c.string(),signature_algorithm:c.string(),sans:c.string().nullable(),is_ca:c.boolean(),position_in_chain:c.number(),quote:c.string().nullable()})).nullable(),tcb_info:c.object({mrtd:c.string(),rootfs_hash:c.string(),rtmr0:c.string(),rtmr1:c.string(),rtmr2:c.string(),rtmr3:c.string(),event_log:c.array(c.object({imr:c.number(),event_type:c.number(),digest:c.string(),event:c.string(),event_payload:c.string()}))}).nullable(),compose_file:c.string().nullable()}),qu=c.object({name:c.string(),description:c.string().optional(),version:c.array(c.number()).optional(),is_dev:c.boolean().optional(),os_image_hash:c.string().nullable().optional(),rootfs_hash:c.string().optional(),shared_ro:c.boolean().optional(),cmdline:c.string().optional(),kernel:c.string().optional(),initrd:c.string().optional(),hda:c.string().nullable().optional(),rootfs:c.string().optional(),bios:c.string().optional()}),Yg=c.object({teepod_id:c.number().nullable(),id:c.number().optional(),name:c.string(),listed:c.boolean().optional(),resource_score:c.number().optional(),remaining_vcpu:c.number().optional(),remaining_memory:c.number().optional(),remaining_cvm_slots:c.number().optional(),images:c.array(qu).optional(),region_identifier:c.string().optional(),dedicated_for_team_id:c.number().nullable().optional(),support_onchain_kms:c.boolean().optional(),fmspc:c.string().nullable().optional(),device_id:c.string().nullable().optional()});import Mu from"inquirer";async function Gu(e){let t=await N(),r=e.replace(/^app_/,""),o=await dt(t,{app_id:r});if(!o.success)throw new Error(o.error.message);return o.data}async function sb(e){let t=await N(),r=await mo(t,{id:e});if(!r.success)throw new Error(r.error.message);return r.data}async function ib(e){let t=await N(),r=e.replace(/^app_/,""),o=await t.get(`cvms/app_${r}/network`);return ri.parse(o)}async function ab(e){let t=await N(),r=e.replace(/^app_/,""),o=await t.post(`cvms/app_${r}/start`);return(await dt(t,{app_id:r})).data}async function cb(e){let t=await N(),r=e.replace(/^app_/,"");return await t.post(`cvms/app_${r}/stop`),(await dt(t,{app_id:r})).data}async function lb(e){let t=await N(),r=e.replace(/^app_/,"");return await t.post(`cvms/app_${r}/restart`),(await dt(t,{app_id:r})).data}async function pb(e){let t=await N(),r=e.replace(/^app_/,"");return await t.delete(`cvms/app_${r}`),!0}async function ub(){let e=je.startSpinner("Fetching available CVMs"),t=await N(),r=await fo(t);if(e.stop(!0),!r.success){je.error(`Failed to fetch CVMs: ${r.error.message}`);return}let n=r.data.items;if(!n||n.length===0){je.info("No CVMs found for your account");return}let s=n.map(a=>{let l=a,f=l.hosted?.app_id||l.hosted?.id,m=l.name||l.hosted?.name,p=l.status||l.hosted?.status;return{name:`${m||"Unnamed"} (${f}) - Status: ${p||"Unknown"}`,value:f}}),{selectedCvm:i}=await Mu.prompt([{type:"list",name:"selectedCvm",message:"Select a CVM:",choices:s}]);return i}async function fb(e){let t=await N(),r=e.replace(/^app_/,""),o=await t.get(`cvms/app_${r}/attestation`);try{return ni.parse(o)}catch(n){return je.debug(`Validation error: ${n instanceof Error?n.message:String(n)}`),{is_online:!!o?.is_online,is_public:!!o?.is_public,error:typeof o?.error=="string"?o.error:null,app_certificates:Array.isArray(o?.app_certificates)?o.app_certificates:null,tcb_info:o?.tcb_info||null,compose_file:typeof o?.compose_file=="string"?o.compose_file:null}}}async function mb(e,t){let r=await N(),o=e.replace(/^app_/,""),n=await r.post(`cvms/app_${o}/replicas`,t);return oi.parse(n)}async function db(e,t,r,o,n){let s=await N(),i=e.replace(/^app_/,""),a={};if(t!==void 0&&(a.vcpu=t),r!==void 0&&(a.memory=r),o!==void 0&&(a.disk_size=o),n!==void 0&&(a.allow_restart=n),Object.keys(a).length===0)throw new Error("At least one resource parameter must be provided");return await s.patch(`cvms/app_${i}/resources`,a),!0}async function hb(e){return await(await N()).post("cvms/pubkey/from_cvm_configuration",e)}async function xb(e){let r=await(await N()).post("cvms/from_cvm_configuration",e);return ti.parse(r)}async function gb(e,t){let r=await N(),o=e.replace(/^app_/,"");return await r.put(`cvms/app_${o}/compose`,t)}async function bb(e=!1){let t=await N(),r="teepods/available";return e&&(r+="?v03x_only=1"),await t.get(r)}function wr(e,t){let r=[];t.follow&&r.push("follow"),t.tail&&r.push(`lines=${t.tail}`),t.timestamps&&r.push("timestamps"),r.push("ansi");let o=e.includes("?")?"&":"?";return e+o+r.join("&")}async function si(e,t){let r=e.body?.getReader();if(!r)throw new Error("No response body available for streaming");let o=new TextDecoder;for(;;){let{done:n,value:s}=await r.read();if(n)break;t(o.decode(s,{stream:!0}))}}async function ii(e){let t=await Gu(e);if(!t.syslog_endpoint)throw new Error(`No syslog endpoint available for CVM '${e}'`);return`${t.syslog_endpoint}&ch=serial`}async function ai(e,t){let o=await(await N()).get(`cvms/${e}/composition`);if(!o.containers?.length)throw new Error(`No containers found for CVM '${e}'`);let n=o.containers;if(t&&(n=n.filter(i=>i.names.some(a=>a===t||a===`/${t}`)||i.id.startsWith(t)),!n.length))throw new Error(`Container '${t}' not found in CVM '${e}'`);let s=n.find(i=>i.log_endpoint);if(!s?.log_endpoint)throw new Error(`No log endpoints available for CVM '${e}'`);return s.log_endpoint}async function yb(e,t={}){let r=await ii(e),o=wr(r,t),n=await fetch(o);if(!n.ok)throw new Error(`Failed to fetch serial logs: ${n.status} ${n.statusText}`);return n.text()}async function vb(e,t={}){let r=await ai(e,t.container),o=wr(r,t),n=await fetch(o);if(!n.ok)throw new Error(`Failed to fetch container logs: ${n.status} ${n.statusText}`);return n.text()}async function wb(e,t,r={},o){let n=await ii(e),s=wr(n,{...r,follow:!0}),i=await fetch(s,{signal:o});if(!i.ok)throw new Error(`Failed to stream serial logs: ${i.status} ${i.statusText}`);await si(i,t)}async function _b(e,t,r={},o){let n=await ai(e,r.container),s=wr(n,{...r,follow:!0}),i=await fetch(s,{signal:o});if(!i.ok)throw new Error(`Failed to stream container logs: ${i.status} ${i.statusText}`);await si(i,t)}export{Jg as composeFileSchema,xb as createCvm,ni as cvmAttestationResponseSchema,pb as deleteCvm,Nu as dockerConfigSchema,Zg as encryptedEnvItemSchema,vb as fetchContainerLogs,yb as fetchSerialLogs,fb as getCvmAttestation,Gu as getCvmByAppId,sb as getCvmComposeConfig,ib as getCvmNetwork,ri as getCvmNetworkResponseSchema,hb as getPubkeyFromCvm,bb as getTeepods,qu as imageSchema,ti as postCvmResponseSchema,mb as replicateCvm,oi as replicateCvmResponseSchema,db as resizeCvm,lb as restartCvm,ub as selectCvm,ab as startCvm,cb as stopCvm,_b as streamContainerLogs,wb as streamSerialLogs,Yg as teepodSchema,gb as upgradeCvm};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=index.js.map