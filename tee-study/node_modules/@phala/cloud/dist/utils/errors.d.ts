import { z } from "zod";
import type { FetchError, FetchRequest } from "ofetch";
/**
 * API Error Response Schema
 */
export declare const ApiErrorSchema: z.ZodObject<{
    detail: z.ZodOptional<z.ZodUnion<[z.ZodString, z.ZodArray<z.ZodObject<{
        msg: z.ZodString;
        type: z.ZodOptional<z.ZodString>;
        ctx: z.ZodOptional<z.ZodRecord<z.ZodString, z.ZodUnknown>>;
        loc: z.ZodOptional<z.ZodArray<z.ZodUnion<[z.ZodString, z.ZodNumber]>, "many">>;
        input: z.ZodOptional<z.ZodUnknown>;
    }, "passthrough", z.ZodTypeAny, z.objectOutputType<{
        msg: z.ZodString;
        type: z.ZodOptional<z.ZodString>;
        ctx: z.ZodOptional<z.ZodRecord<z.ZodString, z.ZodUnknown>>;
        loc: z.ZodOptional<z.ZodArray<z.ZodUnion<[z.ZodString, z.ZodNumber]>, "many">>;
        input: z.ZodOptional<z.ZodUnknown>;
    }, z.ZodTypeAny, "passthrough">, z.objectInputType<{
        msg: z.ZodString;
        type: z.ZodOptional<z.ZodString>;
        ctx: z.ZodOptional<z.ZodRecord<z.ZodString, z.ZodUnknown>>;
        loc: z.ZodOptional<z.ZodArray<z.ZodUnion<[z.ZodString, z.ZodNumber]>, "many">>;
        input: z.ZodOptional<z.ZodUnknown>;
    }, z.ZodTypeAny, "passthrough">>, "many">, z.ZodRecord<z.ZodString, z.ZodUnknown>]>>;
    type: z.ZodOptional<z.ZodString>;
    code: z.ZodOptional<z.ZodString>;
}, "strip", z.ZodTypeAny, {
    code?: string | undefined;
    type?: string | undefined;
    detail?: string | Record<string, unknown> | z.objectOutputType<{
        msg: z.ZodString;
        type: z.ZodOptional<z.ZodString>;
        ctx: z.ZodOptional<z.ZodRecord<z.ZodString, z.ZodUnknown>>;
        loc: z.ZodOptional<z.ZodArray<z.ZodUnion<[z.ZodString, z.ZodNumber]>, "many">>;
        input: z.ZodOptional<z.ZodUnknown>;
    }, z.ZodTypeAny, "passthrough">[] | undefined;
}, {
    code?: string | undefined;
    type?: string | undefined;
    detail?: string | Record<string, unknown> | z.objectInputType<{
        msg: z.ZodString;
        type: z.ZodOptional<z.ZodString>;
        ctx: z.ZodOptional<z.ZodRecord<z.ZodString, z.ZodUnknown>>;
        loc: z.ZodOptional<z.ZodArray<z.ZodUnion<[z.ZodString, z.ZodNumber]>, "many">>;
        input: z.ZodOptional<z.ZodUnknown>;
    }, z.ZodTypeAny, "passthrough">[] | undefined;
}>;
export type ApiError = z.infer<typeof ApiErrorSchema>;
/**
 * Structured validation error item from FastAPI/Pydantic
 */
export interface ValidationErrorItem {
    /** Field path (e.g., "name", "body.memory", "query.page") */
    field: string;
    /** Human-readable error message */
    message: string;
    /** Error type from Pydantic (e.g., "string_too_short", "greater_than_equal") */
    type: string;
    /** Additional context (e.g., { min_length: 4 }) */
    context?: Record<string, unknown>;
}
/**
 * Base class for all Phala Cloud API errors
 */
export declare class PhalaCloudError extends Error {
    readonly status: number;
    readonly statusText: string;
    readonly detail?: string | Record<string, unknown> | Array<{
        msg: string;
        type?: string;
        ctx?: Record<string, unknown>;
    }>;
    constructor(message: string, data: {
        status: number;
        statusText: string;
        detail?: string | Record<string, unknown> | Array<{
            msg: string;
            type?: string;
            ctx?: Record<string, unknown>;
        }>;
    });
}
/**
 * Base error class for HTTP requests
 * Extends PhalaCloudError with additional HTTP-specific properties
 */
export declare class RequestError extends PhalaCloudError implements ApiError {
    readonly name = "RequestError";
    readonly isRequestError: true;
    readonly data?: unknown;
    readonly request?: FetchRequest | undefined;
    readonly response?: Response | undefined;
    readonly code?: string | undefined;
    readonly type?: string | undefined;
    constructor(message: string, options?: {
        status?: number | undefined;
        statusText?: string | undefined;
        data?: unknown;
        request?: FetchRequest | undefined;
        response?: Response | undefined;
        cause?: unknown;
        detail?: string | Record<string, unknown> | Array<{
            msg: string;
            type?: string;
            ctx?: Record<string, unknown>;
            loc?: (string | number)[];
            input?: unknown;
            [key: string]: unknown;
        }>;
        code?: string | undefined;
        type?: string | undefined;
    });
    /**
     * Create RequestError from FetchError
     */
    static fromFetchError(error: FetchError): RequestError;
    /**
     * Create RequestError from generic Error
     */
    static fromError(error: Error, request?: FetchRequest): RequestError;
}
/**
 * Validation error from FastAPI/Pydantic (422)
 * Use instanceof to check: if (error instanceof ValidationError) { ... }
 * Or use property: if (error.isValidationError) { ... }
 */
export declare class ValidationError extends PhalaCloudError {
    readonly isValidationError: true;
    readonly validationErrors: ValidationErrorItem[];
    constructor(message: string, data: {
        status: number;
        statusText: string;
        detail?: string | Record<string, unknown> | Array<{
            msg: string;
            type?: string;
            ctx?: Record<string, unknown>;
            loc?: (string | number)[];
            input?: unknown;
            [key: string]: unknown;
        }>;
        validationErrors: ValidationErrorItem[];
    });
}
/**
 * Authentication/Authorization error (401, 403)
 * Use instanceof to check: if (error instanceof AuthError) { ... }
 * Or use property: if (error.isAuthError) { ... }
 */
export declare class AuthError extends PhalaCloudError {
    readonly isAuthError: true;
}
/**
 * Business logic error (400, 409, etc.)
 * Use instanceof to check: if (error instanceof BusinessError) { ... }
 * Or use property: if (error.isBusinessError) { ... }
 */
export declare class BusinessError extends PhalaCloudError {
    readonly isBusinessError: true;
}
/**
 * Server error (500+)
 * Use instanceof to check: if (error instanceof ServerError) { ... }
 * Or use property: if (error.isServerError) { ... }
 */
export declare class ServerError extends PhalaCloudError {
    readonly isServerError: true;
}
/**
 * Unknown error (network issues, etc.)
 * Use instanceof to check: if (error instanceof UnknownError) { ... }
 * Or use property: if (error.isUnknownError) { ... }
 */
export declare class UnknownError extends PhalaCloudError {
    readonly isUnknownError: true;
}
/**
 * Parse RequestError into PhalaCloudError instance
 *
 * Returns the appropriate error subclass based on status code:
 * - New structured errors (with error_code) → ResourceError
 * - 422 → ValidationError (with validationErrors array)
 * - 401, 403 → AuthError
 * - 400, 409, etc. → BusinessError
 * - 500+ → ServerError
 * - Other → UnknownError
 *
 * @param requestError - The RequestError from API call
 * @returns PhalaCloudError subclass instance
 *
 * @example
 * ```typescript
 * try {
 *   await client.post('/cvms', data);
 * } catch (error) {
 *   if (error instanceof ResourceError) {
 *     // New structured error with error code
 *     console.error(`Error [${error.errorCode}]: ${error.message}`);
 *     if (error.suggestions) {
 *       error.suggestions.forEach(s => console.log(s));
 *     }
 *   } else if (error instanceof ValidationError) {
 *     // TypeScript knows error.validationErrors exists
 *     error.validationErrors.forEach(e => {
 *       console.error(`${e.field}: ${e.message}`);
 *     });
 *   } else if (error instanceof AuthError) {
 *     // Handle auth error
 *   }
 * }
 * ```
 */
export declare function parseApiError(requestError: RequestError): PhalaCloudError;
/**
 * Extract all field names from validation errors
 *
 * @deprecated Use `error instanceof ValidationError` and `error.validationErrors` directly
 */
export declare function getValidationFields(error: PhalaCloudError): string[];
/**
 * Format validation errors for display
 *
 * @param errors - Array of validation error items
 * @param options - Formatting options
 * @returns Formatted string for display
 *
 * @example
 * ```typescript
 * if (error instanceof ValidationError) {
 *   const formatted = formatValidationErrors(error.validationErrors, {
 *     numbered: true,
 *     indent: 2
 *   });
 *   console.error(formatted);
 * }
 * // Output:
 * //   1. name: String should have at least 4 characters
 * //   2. memory: Input should be greater than or equal to 1024
 * ```
 */
export declare function formatValidationErrors(errors: ValidationErrorItem[], options?: {
    /** Add numbers to each error (default: true) */
    numbered?: boolean;
    /** Indent size in spaces (default: 2) */
    indent?: number;
    /** Show field names (default: true) */
    showFields?: boolean;
}): string;
/**
 * Create a user-friendly error message from PhalaCloudError
 *
 * @param error - Phala Cloud API error
 * @param options - Formatting options
 * @returns Formatted error message
 *
 * @example
 * ```typescript
 * try {
 *   await client.post('/cvms', data);
 * } catch (error) {
 *   if (error instanceof PhalaCloudError) {
 *     console.error(formatErrorMessage(error));
 *   }
 * }
 * // Output:
 * // Validation failed (2 issues)
 * //
 * //   1. name: String should have at least 4 characters
 * //   2. memory: Input should be greater than or equal to 1024
 * ```
 */
export declare function formatErrorMessage(error: PhalaCloudError, options?: {
    /** Include field names in validation errors (default: true) */
    showFields?: boolean;
    /** Include error class name in output (default: false) */
    showType?: boolean;
}): string;
/**
 * Extract error message from API error
 *
 * @param error - API error object
 * @returns Error message string
 */
export declare function getErrorMessage(error: ApiError): string;
/**
 * Structured error detail from new error format (ERR-xxxx codes)
 */
export interface StructuredErrorDetail {
    field?: string;
    value?: unknown;
    message?: string;
}
/**
 * Error link from structured error response
 */
export interface ErrorLink {
    url: string;
    label: string;
}
/**
 * New structured error response format with unique error codes
 */
export interface StructuredErrorResponse {
    error_code: string;
    message: string;
    details?: StructuredErrorDetail[];
    suggestions?: string[];
    links?: ErrorLink[];
}
/**
 * Resource provisioning error with structured details
 * Extends BusinessError to handle new error format from backend
 *
 * Use instanceof to check: if (error instanceof ResourceError) { ... }
 * Or use property: if (error.isResourceError) { ... }
 */
export declare class ResourceError extends BusinessError {
    readonly isResourceError: true;
    readonly errorCode?: string;
    readonly structuredDetails?: StructuredErrorDetail[];
    readonly suggestions?: string[];
    readonly links?: ErrorLink[];
    constructor(message: string, data: {
        status: number;
        statusText: string;
        detail?: string | Record<string, unknown> | Array<{
            msg: string;
            type?: string;
            ctx?: Record<string, unknown>;
            loc?: (string | number)[];
            input?: unknown;
            [key: string]: unknown;
        }>;
        errorCode?: string;
        structuredDetails?: StructuredErrorDetail[];
        suggestions?: string[];
        links?: ErrorLink[];
    });
}
/**
 * Format structured error for display
 *
 * @param error - Resource error with structured details
 * @param options - Formatting options
 * @returns Formatted error message
 *
 * @example
 * ```typescript
 * try {
 *   await client.provisionCvm(payload);
 * } catch (error) {
 *   if (error instanceof ResourceError) {
 *     console.error(formatStructuredError(error));
 *   }
 * }
 * // Output:
 * // Error [ERR-01-001]: The requested instance type does not exist
 * //
 * // Details:
 * //   - Instance type 'invalid' is not recognized
 * //
 * // Suggestions:
 * //   - Use a valid instance type: tdx.small, tdx.medium, or tdx.large
 * //   - Alternatively, specify CPU and memory requirements manually
 * //
 * // Learn more:
 * //   - View available instance types: https://cloud.phala.network/instances
 * //   - Contact support: https://cloud.phala.network/support
 * ```
 */
export declare function formatStructuredError(error: ResourceError, options?: {
    /** Show error code in output (default: true) */
    showErrorCode?: boolean;
    /** Show suggestions (default: true) */
    showSuggestions?: boolean;
    /** Show links (default: true) */
    showLinks?: boolean;
}): string;
