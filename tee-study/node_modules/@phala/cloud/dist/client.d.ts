import { ofetch, type FetchOptions, type FetchRequest } from "ofetch";
import { type Handler } from "mitt";
import { type SafeResult, type ClientConfig } from "./types/client";
import type { Prettify } from "./types/common";
import { PhalaCloudError } from "./utils/errors";
export type { SafeResult } from "./types/client";
export declare const SUPPORTED_API_VERSIONS: readonly ["2025-05-31", "2025-10-28"];
/**
 * Client event types
 */
type ClientEvents = {
    error: PhalaCloudError;
};
/**
 * HTTP Client class with ofetch compatibility
 */
export declare class Client {
    protected fetchInstance: typeof ofetch;
    readonly config: ClientConfig;
    private emitter;
    constructor(config?: ClientConfig);
    /**
     * Get the underlying ofetch instance for advanced usage
     */
    get raw(): import("ofetch").$Fetch;
    /**
     * Listen for error events
     * @param type - Event type ('error' or '*' for all events)
     * @param handler - Event handler function
     *
     * @example
     * ```typescript
     * // Listen to error events
     * client.on('error', (error) => {
     *   console.error('API Error:', error.message);
     * });
     *
     * // Listen to all events
     * client.on('*', (type, error) => {
     *   console.log('Event:', type, error);
     * });
     * ```
     */
    on<K extends keyof ClientEvents>(type: K, handler: Handler<ClientEvents[K]>): void;
    on(type: "*", handler: Handler): void;
    /**
     * Remove event listener
     * @param type - Event type ('error' or '*' for all events)
     * @param handler - Event handler function to remove
     *
     * @example
     * ```typescript
     * const errorHandler = (error) => console.error(error);
     * client.on('error', errorHandler);
     * client.off('error', errorHandler);
     * ```
     */
    off<K extends keyof ClientEvents>(type: K, handler?: Handler<ClientEvents[K]>): void;
    off(type: "*", handler?: Handler): void;
    /**
     * Listen for event once (automatically removed after first trigger)
     * @param type - Event type ('error' or '*' for all events)
     * @param handler - Event handler function
     *
     * @example
     * ```typescript
     * client.once('error', (error) => {
     *   console.error('First error:', error);
     * });
     * ```
     */
    once<K extends keyof ClientEvents>(type: K, handler: Handler<ClientEvents[K]>): void;
    once(type: "*", handler: Handler): void;
    /**
     * Perform GET request (throws PhalaCloudError on error)
     */
    get<T = unknown>(request: FetchRequest, options?: Omit<FetchOptions, "method">): Promise<T>;
    /**
     * Perform POST request (throws PhalaCloudError on error)
     */
    post<T = unknown>(request: FetchRequest, body?: RequestInit["body"] | Record<string, unknown>, options?: Omit<FetchOptions, "method" | "body">): Promise<T>;
    /**
     * Perform PUT request (throws PhalaCloudError on error)
     */
    put<T = unknown>(request: FetchRequest, body?: RequestInit["body"] | Record<string, unknown>, options?: Omit<FetchOptions, "method" | "body">): Promise<T>;
    /**
     * Perform PATCH request (throws PhalaCloudError on error)
     */
    patch<T = unknown>(request: FetchRequest, body?: RequestInit["body"] | Record<string, unknown>, options?: Omit<FetchOptions, "method" | "body">): Promise<T>;
    /**
     * Perform DELETE request (throws PhalaCloudError on error)
     */
    delete<T = unknown>(request: FetchRequest, options?: Omit<FetchOptions, "method">): Promise<T>;
    /**
     * Convert any error to RequestError
     */
    private convertToRequestError;
    /**
     * Broadcast error to event listeners (fire-and-forget)
     * @param requestError - The request error to handle
     * @returns PhalaCloudError instance to throw immediately
     */
    private emitError;
    /**
     * Safe wrapper for any request method (zod-style result)
     * Returns PhalaCloudError (all errors extend this base class)
     */
    private safeRequest;
    /**
     * Safe GET request (returns SafeResult)
     */
    safeGet<T = unknown>(request: FetchRequest, options?: Omit<FetchOptions, "method">): Promise<SafeResult<T, PhalaCloudError>>;
    /**
     * Safe POST request (returns SafeResult)
     */
    safePost<T = unknown>(request: FetchRequest, body?: RequestInit["body"] | Record<string, unknown>, options?: Omit<FetchOptions, "method" | "body">): Promise<SafeResult<T, PhalaCloudError>>;
    /**
     * Safe PUT request (returns SafeResult)
     */
    safePut<T = unknown>(request: FetchRequest, body?: RequestInit["body"] | Record<string, unknown>, options?: Omit<FetchOptions, "method" | "body">): Promise<SafeResult<T, PhalaCloudError>>;
    /**
     * Safe PATCH request (returns SafeResult)
     */
    safePatch<T = unknown>(request: FetchRequest, body?: RequestInit["body"] | Record<string, unknown>, options?: Omit<FetchOptions, "method" | "body">): Promise<SafeResult<T, PhalaCloudError>>;
    /**
     * Safe DELETE request (returns SafeResult)
     */
    safeDelete<T = unknown>(request: FetchRequest, options?: Omit<FetchOptions, "method">): Promise<SafeResult<T, PhalaCloudError>>;
    /**
     * Extend client with additional actions
     *
     * @example
     * ```typescript
     * const client = createClient({ apiKey: 'xxx' })
     *   .extend(publicActions)
     *   .extend(cvmActions)
     *
     * await client.getCurrentUser() // Method call instead of function call
     * ```
     */
    extend<TActions extends Record<string, unknown>>(actions: TActions | ((client: Client) => TActions)): Prettify<this & {
        [K in keyof TActions]: TActions[K] extends (client: Client) => infer R ? () => R : TActions[K] extends (client: Client, ...args: infer P) => infer R ? (...args: P) => R : never;
    }>;
}
/**
 * Create a new HTTP client instance
 *
 * Configuration can be provided via parameters or environment variables:
 * - PHALA_CLOUD_API_KEY: API key for authentication
 * - PHALA_CLOUD_API_PREFIX: Base URL prefix for the API
 *
 * Debug Logging:
 * - Set DEBUG=phala::api-client to enable cURL-like request/response logging
 * - This will print detailed information about each API call in a format similar to cURL
 *
 * @example
 * ```typescript
 * // Using explicit configuration
 * const client = createClient({
 *   apiKey: 'your-api-key',
 *   baseURL: 'https://custom-api.example.com'
 * })
 *
 * // Using environment variables (set PHALA_CLOUD_API_KEY)
 * const client = createClient()
 *
 * // To enable debug logging:
 * // DEBUG=phala::api-client node your-script.js
 * ```
 */
export declare function createClient(config?: ClientConfig): Client;
