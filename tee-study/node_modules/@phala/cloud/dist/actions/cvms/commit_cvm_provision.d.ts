import { z } from "zod";
import { type Client } from "../../client";
/**
 * Commit CVM Provision (Create CVM from provisioned data)
 *
 * This action creates a CVM using previously provisioned data and encrypted environment variables.
 * It MUST be called after `provisionCvm` to complete the CVM deployment process.
 *
 * ## Two-Step Deployment Flow
 *
 * 1. **Provision** (`provisionCvm`): Prepares resources and returns `compose_hash` (and `app_id` for PHALA KMS)
 * 2. **Commit** (this function): Creates the actual CVM using provisioned data
 *
 * ## KMS Type and app_id Source
 *
 * The `app_id` source depends on the KMS type used during provisioning:
 *
 * - **PHALA KMS** (default): `app_id` is obtained from centralized KMS - returned by `provisionCvm()`
 * - **ETHEREUM/BASE KMS** (on-chain): `app_id` must be obtained by deploying your contract and interacting with the on-chain KMS - NOT provided by `provisionCvm()`
 *
 * @example
 * ```typescript
 * import { createClient, provisionCvm, commitCvmProvision } from '@phala/cloud'
 *
 * const client = createClient();
 *
 * // Example 1: PHALA KMS (default - app_id from provision)
 * const provision = await provisionCvm(client, {
 *   name: "my-cvm",
 *   instance_type: "tdx.small",
 *   kms: "PHALA",  // or omit for default
 *   compose_file: { docker_compose_file: "..." },
 * });
 *
 * // app_id is provided by provision API
 * const cvm = await commitCvmProvision(client, {
 *   app_id: provision.app_id,           // From provision response
 *   compose_hash: provision.compose_hash,
 *   encrypted_env: "...",
 * });
 *
 * // Example 2: On-chain KMS (app_id from contract deployment)
 * const provision = await provisionCvm(client, {
 *   name: "my-cvm",
 *   instance_type: "tdx.small",
 *   kms: "ETHEREUM",  // or "BASE" for Base network
 *   compose_file: { docker_compose_file: "..." },
 * });
 *
 * // Step 1: Deploy your contract and get app_id from on-chain KMS
 * const contractTx = await deployContract({
 *   kmsContract: "0x...",
 *   // ... contract deployment params
 * });
 * const appId = await getAppIdFromKms(contractTx);
 *
 * // Step 2: Commit with app_id from on-chain interaction
 * const cvm = await commitCvmProvision(client, {
 *   app_id: appId,                        // From on-chain KMS, NOT from provision
 *   compose_hash: provision.compose_hash, // From provision response
 *   contract_address: "0x123...",         // Your deployed contract
 *   deployer_address: "0x456...",         // Deployer address
 * });
 * ```
 *
 * ## Returns
 *
 * `CommitCvmProvision | unknown`
 *
 * The created CVM details including id, name, status, and other metadata. Return type depends on schema parameter.
 *
 * ## Required Parameters
 *
 * - **app_id**: Application identifier
 *   - For PHALA KMS: Use `provision.app_id` from `provisionCvm()` response
 *   - For ETHEREUM/BASE KMS (on-chain): Obtain from your on-chain KMS contract deployment
 * - **compose_hash**: Must be obtained from `provisionCvm()` response (used to retrieve provision data from Redis)
 *
 * ## Optional Parameters
 *
 * - **encrypted_env**: Hex-encoded encrypted environment variables
 * - **env_keys**: List of environment variable keys to allow
 * - **kms_id**: KMS instance identifier (if using specific KMS)
 * - **contract_address**: On-chain KMS contract address (required for ETHEREUM/BASE KMS)
 * - **deployer_address**: Deployer address for on-chain verification (required for ETHEREUM/BASE KMS)
 *
 * ## Schema Parameter
 *
 * - **Type:** `ZodSchema | false`
 * - **Default:** `CommitCvmProvisionSchema`
 *
 * Schema to validate the response. Use `false` to return raw data without validation.
 *
 * ```typescript
 * // Use default schema
 * const result = await commitCvmProvision(client, payload)
 *
 * // Return raw data without validation
 * const raw = await commitCvmProvision(client, payload, { schema: false })
 *
 * // Use custom schema
 * const customSchema = z.object({ id: z.number(), name: z.string() })
 * const custom = await commitCvmProvision(client, payload, { schema: customSchema })
 * ```
 *
 * ## Safe Version
 *
 * Use `safeCommitCvmProvision` for error handling without exceptions:
 *
 * ```typescript
 * import { safeCommitCvmProvision } from '@phala/cloud'
 *
 * const result = await safeCommitCvmProvision(client, payload)
 * if (result.success) {
 *   console.log(result.data)
 * } else {
 *   if ("isRequestError" in result.error) {
 *     console.error(`HTTP ${result.error.status}: ${result.error.message}`)
 *   } else {
 *     console.error(`Validation error: ${result.error.issues}`)
 *   }
 * }
 * ```
 */
export declare const CommitCvmProvisionSchema: z.ZodObject<{
    id: z.ZodNumber;
    name: z.ZodString;
    status: z.ZodString;
    teepod_id: z.ZodNumber;
    teepod: z.ZodNullable<z.ZodObject<{
        id: z.ZodNumber;
        name: z.ZodString;
    }, "strip", z.ZodTypeAny, {
        name: string;
        id: number;
    }, {
        name: string;
        id: number;
    }>>;
    user_id: z.ZodNullable<z.ZodNumber>;
    app_id: z.ZodNullable<z.ZodString>;
    vm_uuid: z.ZodNullable<z.ZodString>;
    instance_id: z.ZodNullable<z.ZodString>;
    app_url: z.ZodNullable<z.ZodString>;
    base_image: z.ZodNullable<z.ZodString>;
    vcpu: z.ZodNumber;
    memory: z.ZodNumber;
    disk_size: z.ZodNumber;
    manifest_version: z.ZodNullable<z.ZodNumber>;
    version: z.ZodNullable<z.ZodString>;
    runner: z.ZodNullable<z.ZodString>;
    docker_compose_file: z.ZodNullable<z.ZodString>;
    features: z.ZodNullable<z.ZodArray<z.ZodString, "many">>;
    created_at: z.ZodString;
    encrypted_env_pubkey: z.ZodOptional<z.ZodNullable<z.ZodString>>;
    app_auth_contract_address: z.ZodOptional<z.ZodNullable<z.ZodString>>;
    deployer_address: z.ZodOptional<z.ZodNullable<z.ZodString>>;
}, "passthrough", z.ZodTypeAny, z.objectOutputType<{
    id: z.ZodNumber;
    name: z.ZodString;
    status: z.ZodString;
    teepod_id: z.ZodNumber;
    teepod: z.ZodNullable<z.ZodObject<{
        id: z.ZodNumber;
        name: z.ZodString;
    }, "strip", z.ZodTypeAny, {
        name: string;
        id: number;
    }, {
        name: string;
        id: number;
    }>>;
    user_id: z.ZodNullable<z.ZodNumber>;
    app_id: z.ZodNullable<z.ZodString>;
    vm_uuid: z.ZodNullable<z.ZodString>;
    instance_id: z.ZodNullable<z.ZodString>;
    app_url: z.ZodNullable<z.ZodString>;
    base_image: z.ZodNullable<z.ZodString>;
    vcpu: z.ZodNumber;
    memory: z.ZodNumber;
    disk_size: z.ZodNumber;
    manifest_version: z.ZodNullable<z.ZodNumber>;
    version: z.ZodNullable<z.ZodString>;
    runner: z.ZodNullable<z.ZodString>;
    docker_compose_file: z.ZodNullable<z.ZodString>;
    features: z.ZodNullable<z.ZodArray<z.ZodString, "many">>;
    created_at: z.ZodString;
    encrypted_env_pubkey: z.ZodOptional<z.ZodNullable<z.ZodString>>;
    app_auth_contract_address: z.ZodOptional<z.ZodNullable<z.ZodString>>;
    deployer_address: z.ZodOptional<z.ZodNullable<z.ZodString>>;
}, z.ZodTypeAny, "passthrough">, z.objectInputType<{
    id: z.ZodNumber;
    name: z.ZodString;
    status: z.ZodString;
    teepod_id: z.ZodNumber;
    teepod: z.ZodNullable<z.ZodObject<{
        id: z.ZodNumber;
        name: z.ZodString;
    }, "strip", z.ZodTypeAny, {
        name: string;
        id: number;
    }, {
        name: string;
        id: number;
    }>>;
    user_id: z.ZodNullable<z.ZodNumber>;
    app_id: z.ZodNullable<z.ZodString>;
    vm_uuid: z.ZodNullable<z.ZodString>;
    instance_id: z.ZodNullable<z.ZodString>;
    app_url: z.ZodNullable<z.ZodString>;
    base_image: z.ZodNullable<z.ZodString>;
    vcpu: z.ZodNumber;
    memory: z.ZodNumber;
    disk_size: z.ZodNumber;
    manifest_version: z.ZodNullable<z.ZodNumber>;
    version: z.ZodNullable<z.ZodString>;
    runner: z.ZodNullable<z.ZodString>;
    docker_compose_file: z.ZodNullable<z.ZodString>;
    features: z.ZodNullable<z.ZodArray<z.ZodString, "many">>;
    created_at: z.ZodString;
    encrypted_env_pubkey: z.ZodOptional<z.ZodNullable<z.ZodString>>;
    app_auth_contract_address: z.ZodOptional<z.ZodNullable<z.ZodString>>;
    deployer_address: z.ZodOptional<z.ZodNullable<z.ZodString>>;
}, z.ZodTypeAny, "passthrough">>;
export type CommitCvmProvision = z.infer<typeof CommitCvmProvisionSchema>;
export declare const CommitCvmProvisionRequestSchema: z.ZodObject<{
    encrypted_env: z.ZodNullable<z.ZodOptional<z.ZodString>>;
    app_id: z.ZodString;
    compose_hash: z.ZodString;
    kms_id: z.ZodOptional<z.ZodString>;
    contract_address: z.ZodOptional<z.ZodString>;
    deployer_address: z.ZodOptional<z.ZodString>;
    env_keys: z.ZodNullable<z.ZodOptional<z.ZodArray<z.ZodString, "many">>>;
}, "passthrough", z.ZodTypeAny, z.objectOutputType<{
    encrypted_env: z.ZodNullable<z.ZodOptional<z.ZodString>>;
    app_id: z.ZodString;
    compose_hash: z.ZodString;
    kms_id: z.ZodOptional<z.ZodString>;
    contract_address: z.ZodOptional<z.ZodString>;
    deployer_address: z.ZodOptional<z.ZodString>;
    env_keys: z.ZodNullable<z.ZodOptional<z.ZodArray<z.ZodString, "many">>>;
}, z.ZodTypeAny, "passthrough">, z.objectInputType<{
    encrypted_env: z.ZodNullable<z.ZodOptional<z.ZodString>>;
    app_id: z.ZodString;
    compose_hash: z.ZodString;
    kms_id: z.ZodOptional<z.ZodString>;
    contract_address: z.ZodOptional<z.ZodString>;
    deployer_address: z.ZodOptional<z.ZodString>;
    env_keys: z.ZodNullable<z.ZodOptional<z.ZodArray<z.ZodString, "many">>>;
}, z.ZodTypeAny, "passthrough">>;
export type CommitCvmProvisionRequest = z.infer<typeof CommitCvmProvisionRequestSchema>;
declare const commitCvmProvision: {
    (client: Client, params: z.objectOutputType<{
        encrypted_env: z.ZodNullable<z.ZodOptional<z.ZodString>>;
        app_id: z.ZodString;
        compose_hash: z.ZodString;
        kms_id: z.ZodOptional<z.ZodString>;
        contract_address: z.ZodOptional<z.ZodString>;
        deployer_address: z.ZodOptional<z.ZodString>;
        env_keys: z.ZodNullable<z.ZodOptional<z.ZodArray<z.ZodString, "many">>>;
    }, z.ZodTypeAny, "passthrough">): Promise<z.objectOutputType<{
        id: z.ZodNumber;
        name: z.ZodString;
        status: z.ZodString;
        teepod_id: z.ZodNumber;
        teepod: z.ZodNullable<z.ZodObject<{
            id: z.ZodNumber;
            name: z.ZodString;
        }, "strip", z.ZodTypeAny, {
            name: string;
            id: number;
        }, {
            name: string;
            id: number;
        }>>;
        user_id: z.ZodNullable<z.ZodNumber>;
        app_id: z.ZodNullable<z.ZodString>;
        vm_uuid: z.ZodNullable<z.ZodString>;
        instance_id: z.ZodNullable<z.ZodString>;
        app_url: z.ZodNullable<z.ZodString>;
        base_image: z.ZodNullable<z.ZodString>;
        vcpu: z.ZodNumber;
        memory: z.ZodNumber;
        disk_size: z.ZodNumber;
        manifest_version: z.ZodNullable<z.ZodNumber>;
        version: z.ZodNullable<z.ZodString>;
        runner: z.ZodNullable<z.ZodString>;
        docker_compose_file: z.ZodNullable<z.ZodString>;
        features: z.ZodNullable<z.ZodArray<z.ZodString, "many">>;
        created_at: z.ZodString;
        encrypted_env_pubkey: z.ZodOptional<z.ZodNullable<z.ZodString>>;
        app_auth_contract_address: z.ZodOptional<z.ZodNullable<z.ZodString>>;
        deployer_address: z.ZodOptional<z.ZodNullable<z.ZodString>>;
    }, z.ZodTypeAny, "passthrough">>;
    <T extends z.ZodTypeAny>(client: Client, params: z.objectOutputType<{
        encrypted_env: z.ZodNullable<z.ZodOptional<z.ZodString>>;
        app_id: z.ZodString;
        compose_hash: z.ZodString;
        kms_id: z.ZodOptional<z.ZodString>;
        contract_address: z.ZodOptional<z.ZodString>;
        deployer_address: z.ZodOptional<z.ZodString>;
        env_keys: z.ZodNullable<z.ZodOptional<z.ZodArray<z.ZodString, "many">>>;
    }, z.ZodTypeAny, "passthrough">, parameters: {
        schema: T;
    }): Promise<z.TypeOf<T>>;
    (client: Client, params: z.objectOutputType<{
        encrypted_env: z.ZodNullable<z.ZodOptional<z.ZodString>>;
        app_id: z.ZodString;
        compose_hash: z.ZodString;
        kms_id: z.ZodOptional<z.ZodString>;
        contract_address: z.ZodOptional<z.ZodString>;
        deployer_address: z.ZodOptional<z.ZodString>;
        env_keys: z.ZodNullable<z.ZodOptional<z.ZodArray<z.ZodString, "many">>>;
    }, z.ZodTypeAny, "passthrough">, parameters: {
        schema: false;
    }): Promise<unknown>;
}, safeCommitCvmProvision: {
    (client: Client, params: z.objectOutputType<{
        encrypted_env: z.ZodNullable<z.ZodOptional<z.ZodString>>;
        app_id: z.ZodString;
        compose_hash: z.ZodString;
        kms_id: z.ZodOptional<z.ZodString>;
        contract_address: z.ZodOptional<z.ZodString>;
        deployer_address: z.ZodOptional<z.ZodString>;
        env_keys: z.ZodNullable<z.ZodOptional<z.ZodArray<z.ZodString, "many">>>;
    }, z.ZodTypeAny, "passthrough">): Promise<import("../..").SafeResult<z.objectOutputType<{
        id: z.ZodNumber;
        name: z.ZodString;
        status: z.ZodString;
        teepod_id: z.ZodNumber;
        teepod: z.ZodNullable<z.ZodObject<{
            id: z.ZodNumber;
            name: z.ZodString;
        }, "strip", z.ZodTypeAny, {
            name: string;
            id: number;
        }, {
            name: string;
            id: number;
        }>>;
        user_id: z.ZodNullable<z.ZodNumber>;
        app_id: z.ZodNullable<z.ZodString>;
        vm_uuid: z.ZodNullable<z.ZodString>;
        instance_id: z.ZodNullable<z.ZodString>;
        app_url: z.ZodNullable<z.ZodString>;
        base_image: z.ZodNullable<z.ZodString>;
        vcpu: z.ZodNumber;
        memory: z.ZodNumber;
        disk_size: z.ZodNumber;
        manifest_version: z.ZodNullable<z.ZodNumber>;
        version: z.ZodNullable<z.ZodString>;
        runner: z.ZodNullable<z.ZodString>;
        docker_compose_file: z.ZodNullable<z.ZodString>;
        features: z.ZodNullable<z.ZodArray<z.ZodString, "many">>;
        created_at: z.ZodString;
        encrypted_env_pubkey: z.ZodOptional<z.ZodNullable<z.ZodString>>;
        app_auth_contract_address: z.ZodOptional<z.ZodNullable<z.ZodString>>;
        deployer_address: z.ZodOptional<z.ZodNullable<z.ZodString>>;
    }, z.ZodTypeAny, "passthrough">>>;
    <T extends z.ZodTypeAny>(client: Client, params: z.objectOutputType<{
        encrypted_env: z.ZodNullable<z.ZodOptional<z.ZodString>>;
        app_id: z.ZodString;
        compose_hash: z.ZodString;
        kms_id: z.ZodOptional<z.ZodString>;
        contract_address: z.ZodOptional<z.ZodString>;
        deployer_address: z.ZodOptional<z.ZodString>;
        env_keys: z.ZodNullable<z.ZodOptional<z.ZodArray<z.ZodString, "many">>>;
    }, z.ZodTypeAny, "passthrough">, parameters: {
        schema: T;
    }): Promise<import("../..").SafeResult<z.TypeOf<T>>>;
    (client: Client, params: z.objectOutputType<{
        encrypted_env: z.ZodNullable<z.ZodOptional<z.ZodString>>;
        app_id: z.ZodString;
        compose_hash: z.ZodString;
        kms_id: z.ZodOptional<z.ZodString>;
        contract_address: z.ZodOptional<z.ZodString>;
        deployer_address: z.ZodOptional<z.ZodString>;
        env_keys: z.ZodNullable<z.ZodOptional<z.ZodArray<z.ZodString, "many">>>;
    }, z.ZodTypeAny, "passthrough">, parameters: {
        schema: false;
    }): Promise<import("../..").SafeResult<unknown>>;
};
export { commitCvmProvision, safeCommitCvmProvision };
